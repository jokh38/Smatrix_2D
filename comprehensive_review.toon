timestamp: 2026-01-09T09:44:08.899569+09:00
workspace: /workspaces/Smatrix_2D
summary:
  files_analyzed: 28
  total_issues: 24
  quality_score: 86
    [8]
    - cdscan
    - cdqa
    - ruff
    - ty
    - semgrep
    - complexipy
    - skylos
    - pattern_analyzer
codebase_structure:
  codebase_summary:
    total_files: 28
    total_functions: 202
    total_classes: 37
    total_symbols: 0
    primary_language: python
  structure_analysis:
      [20] {path, language, functions, classes, imports, docstring, entry_point, calls}
      setup.py | python | [] | [] | {'external': ['setuptools']} | Setup script for smatrix_2d package. | None | []
      __init__.py | python | [] | [] | {'external': ['smatrix_2d']} | Operator-Factorized Generalized 2D Transport System | None | []
      examples/demo_transport.py | python | [{'name': 'main', 'line': 30, 'params': [], 'complexity': 4, 'nesting_depth': 1}, {'name': 'stopping_power', 'line': 102, 'params': ['E_MeV'], 'complexity': 1, 'nesting_depth': 3}] | [] | {'stdlib': ['os', 'sys'], 'external': ['numpy', 'smatrix_2d']} | Demo script for operator-factorized 2D transport. | {'type': 'main_block', 'line': 186} | [{'caller': 'main', 'callee': 'PhysicsConstants2D'}, {'caller': 'main', 'callee': 'np.argmax'}, {'caller': 'main', 'callee': 'SpatialStreamingOperator'}, {'caller': 'main', 'callee': 'abs'}, {'caller': 'main', 'callee': 'create_initial_state'}, {'caller': 'main', 'callee': 'range'}, {'caller': 'main', 'callee': 'state.total_weight'}, {'caller': 'main', 'callee': 'state.total_dose'}, {'caller': 'main', 'callee': 'GridSpecs2D'}, {'caller': 'main', 'callee': 'EnergyLossOperator'}, {'caller': 'main', 'callee': 'AngularScatteringOperator'}, {'caller': 'main', 'callee': 'create_phase_space_grid'}, {'caller': 'main', 'callee': 'transport.apply'}, {'caller': 'main', 'callee': 'plot_depth_dose'}, {'caller': 'main', 'callee': 'plot_lateral_profile'}, {'caller': 'main', 'callee': 'plot_dose_map'}, {'caller': 'main', 'callee': 'np.sum'}, {'caller': 'main', 'callee': 'print'}, {'caller': 'main', 'callee': 'create_water_material'}, {'caller': 'main', 'callee': 'FirstOrderSplitting'}]
      tests/test_validation.py | python | [{'name': 'test_identical_distributions', 'line': 19, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_scaled_distribution', 'line': 29, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_zero_reference', 'line': 40, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_with_roi_mask', 'line': 51, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_identical_distributions', 'line': 69, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_max_difference', 'line': 79, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_localized_difference', 'line': 90, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_zero_reference', 'line': 104, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_identical_distributions', 'line': 119, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_dose_difference_below_threshold', 'line': 132, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_with_custom_roi', 'line': 147, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_empty_roi', 'line': 166, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_zero_rotation', 'line': 187, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_rotation_of_uniform_field', 'line': 204, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_rotated_gaussian', 'line': 221, 'params': ['self'], 'complexity': 5, 'nesting_depth': 3}, {'name': 'test_first_order_convergence', 'line': 266, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_second_order_convergence', 'line': 276, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_half_order_convergence', 'line': 286, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_no_convergence', 'line': 296, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}] | [{'name': 'TestComputeL2Norm', 'line': 16, 'methods': ['test_identical_distributions', 'test_scaled_distribution', 'test_zero_reference', 'test_with_roi_mask']}, {'name': 'TestComputeLinfNorm', 'line': 66, 'methods': ['test_identical_distributions', 'test_max_difference', 'test_localized_difference', 'test_zero_reference']}, {'name': 'TestComputeGammaPassRate', 'line': 116, 'methods': ['test_identical_distributions', 'test_dose_difference_below_threshold', 'test_with_custom_roi', 'test_empty_roi']}, {'name': 'TestCheckRotationalInvariance', 'line': 184, 'methods': ['test_zero_rotation', 'test_rotation_of_uniform_field', 'test_rotated_gaussian']}, {'name': 'TestComputeConvergenceOrder', 'line': 263, 'methods': ['test_first_order_convergence', 'test_second_order_convergence', 'test_half_order_convergence', 'test_no_convergence']}] | {'external': ['numpy', 'pytest', 'smatrix_2d']} | Tests for validation metrics. | None | [{'caller': 'test_identical_distributions', 'callee': 'pytest.approx'}, {'caller': 'test_identical_distributions', 'callee': 'compute_l2_norm'}, {'caller': 'test_identical_distributions', 'callee': 'np.ones'}, {'caller': 'test_identical_distributions', 'callee': 'compute_gamma_pass_rate'}, {'caller': 'test_identical_distributions', 'callee': 'np.arange'}, {'caller': 'test_identical_distributions', 'callee': 'compute_linf_norm'}, {'caller': 'test_scaled_distribution', 'callee': 'compute_l2_norm'}, {'caller': 'test_scaled_distribution', 'callee': 'np.ones'}, {'caller': 'test_scaled_distribution', 'callee': 'pytest.approx'}, {'caller': 'test_zero_reference', 'callee': 'pytest.approx'}, {'caller': 'test_zero_reference', 'callee': 'np.zeros'}, {'caller': 'test_zero_reference', 'callee': 'compute_l2_norm'}, {'caller': 'test_zero_reference', 'callee': 'np.ones'}, {'caller': 'test_zero_reference', 'callee': 'compute_linf_norm'}, {'caller': 'test_with_roi_mask', 'callee': 'compute_l2_norm'}, {'caller': 'test_with_roi_mask', 'callee': 'np.ones'}, {'caller': 'test_with_roi_mask', 'callee': 'np.zeros'}, {'caller': 'test_max_difference', 'callee': 'compute_linf_norm'}, {'caller': 'test_max_difference', 'callee': 'np.ones'}, {'caller': 'test_max_difference', 'callee': 'pytest.approx'}, {'caller': 'test_localized_difference', 'callee': 'compute_linf_norm'}, {'caller': 'test_localized_difference', 'callee': 'np.ones'}, {'caller': 'test_localized_difference', 'callee': 'pytest.approx'}, {'caller': 'test_dose_difference_below_threshold', 'callee': 'np.ones'}, {'caller': 'test_dose_difference_below_threshold', 'callee': 'compute_gamma_pass_rate'}, {'caller': 'test_dose_difference_below_threshold', 'callee': 'np.arange'}, {'caller': 'test_with_custom_roi', 'callee': 'pytest.approx'}, {'caller': 'test_with_custom_roi', 'callee': 'np.zeros'}, {'caller': 'test_with_custom_roi', 'callee': 'np.ones'}, {'caller': 'test_with_custom_roi', 'callee': 'compute_gamma_pass_rate'}, {'caller': 'test_with_custom_roi', 'callee': 'np.arange'}, {'caller': 'test_empty_roi', 'callee': 'pytest.approx'}, {'caller': 'test_empty_roi', 'callee': 'np.zeros'}, {'caller': 'test_empty_roi', 'callee': 'np.ones'}, {'caller': 'test_empty_roi', 'callee': 'compute_gamma_pass_rate'}, {'caller': 'test_empty_roi', 'callee': 'np.arange'}, {'caller': 'test_zero_rotation', 'callee': 'check_rotational_invariance'}, {'caller': 'test_zero_rotation', 'callee': 'pytest.approx'}, {'caller': 'test_zero_rotation', 'callee': 'np.ones'}, {'caller': 'test_zero_rotation', 'callee': 'np.arange'}, {'caller': 'test_zero_rotation', 'callee': 'dose_a.copy'}, {'caller': 'test_rotation_of_uniform_field', 'callee': 'np.ones'}, {'caller': 'test_rotation_of_uniform_field', 'callee': 'check_rotational_invariance'}, {'caller': 'test_rotation_of_uniform_field', 'callee': 'np.arange'}, {'caller': 'test_rotated_gaussian', 'callee': 'check_rotational_invariance'}, {'caller': 'test_rotated_gaussian', 'callee': 'range'}, {'caller': 'test_rotated_gaussian', 'callee': 'np.meshgrid'}, {'caller': 'test_rotated_gaussian', 'callee': 'np.exp'}, {'caller': 'test_rotated_gaussian', 'callee': 'np.zeros_like'}, {'caller': 'test_rotated_gaussian', 'callee': 'np.argmin'}, {'caller': 'test_rotated_gaussian', 'callee': 'np.sin'}, {'caller': 'test_rotated_gaussian', 'callee': 'np.cos'}, {'caller': 'test_rotated_gaussian', 'callee': 'np.abs'}, {'caller': 'test_rotated_gaussian', 'callee': 'np.arange'}, {'caller': 'test_first_order_convergence', 'callee': 'np.array'}, {'caller': 'test_first_order_convergence', 'callee': 'pytest.approx'}, {'caller': 'test_first_order_convergence', 'callee': 'compute_convergence_order'}, {'caller': 'test_second_order_convergence', 'callee': 'np.array'}, {'caller': 'test_second_order_convergence', 'callee': 'pytest.approx'}, {'caller': 'test_second_order_convergence', 'callee': 'compute_convergence_order'}, {'caller': 'test_half_order_convergence', 'callee': 'np.array'}, {'caller': 'test_half_order_convergence', 'callee': 'np.sqrt'}, {'caller': 'test_half_order_convergence', 'callee': 'pytest.approx'}, {'caller': 'test_half_order_convergence', 'callee': 'compute_convergence_order'}, {'caller': 'test_no_convergence', 'callee': 'abs'}, {'caller': 'test_no_convergence', 'callee': 'np.array'}, {'caller': 'test_no_convergence', 'callee': 'np.ones'}, {'caller': 'test_no_convergence', 'callee': 'compute_convergence_order'}]
      tests/test_operators.py | python | [{'name': 'test_initialization', 'line': 21, 'params': ['self', 'angular_operator', 'grid', 'material', 'constants'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_compute_sigma_theta', 'line': 29, 'params': ['self', 'angular_operator'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_compute_sigma_theta_low_energy', 'line': 43, 'params': ['self', 'angular_operator'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_get_scattering_kernel_normalization', 'line': 49, 'params': ['self', 'angular_operator'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_get_scattering_kernel_periodic_boundary', 'line': 59, 'params': ['self', 'angular_operator'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_apply_conserves_weight', 'line': 78, 'params': ['self', 'angular_operator', 'initial_state'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_apply_preserves_positivity', 'line': 90, 'params': ['self', 'angular_operator', 'initial_state'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_apply_zero_state', 'line': 100, 'params': ['self', 'angular_operator', 'grid'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_apply_with_mid_policy', 'line': 113, 'params': ['self', 'angular_operator_mid_policy', 'initial_state'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_apply_unknown_policy', 'line': 126, 'params': ['self', 'angular_operator', 'initial_state'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_initialization', 'line': 137, 'params': ['self', 'spatial_operator', 'grid', 'constants'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_compute_step_size_forward_transport', 'line': 145, 'params': ['self', 'spatial_operator'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'stopping_power', 'line': 150, 'params': ['E'], 'complexity': 1, 'nesting_depth': 5}, {'name': 'test_check_backward_transport_hard_reject', 'line': 161, 'params': ['self', 'spatial_operator'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_check_backward_transport_forward', 'line': 171, 'params': ['self', 'spatial_operator'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_check_backward_transport_angular_cap', 'line': 181, 'params': ['self', 'spatial_operator_angular_cap'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_check_backward_transport_small_allowance', 'line': 198, 'params': ['self', 'spatial_operator_allowance'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_shift_and_deposit_inside_boundary', 'line': 216, 'params': ['self', 'spatial_operator'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_shift_and_deposit_outside_boundary', 'line': 231, 'params': ['self', 'spatial_operator'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_apply_conserves_or_accounts_weight', 'line': 246, 'params': ['self', 'spatial_operator', 'uniform_state', 'constant_stopping_power'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_apply_preserves_positivity', 'line': 263, 'params': ['self', 'spatial_operator', 'uniform_state', 'constant_stopping_power'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_initialization', 'line': 280, 'params': ['self', 'energy_operator', 'grid'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_apply_conserves_weight_below_cutoff', 'line': 284, 'params': ['self', 'energy_operator', 'uniform_state', 'constant_stopping_power'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_apply_absorbs_below_cutoff', 'line': 305, 'params': ['self', 'energy_operator', 'grid', 'constant_stopping_power'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_apply_preserves_positivity', 'line': 330, 'params': ['self', 'energy_operator', 'uniform_state', 'constant_stopping_power'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_apply_energy_advection', 'line': 344, 'params': ['self', 'energy_operator', 'grid', 'constant_stopping_power'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_apply_with_zero_stopping_power', 'line': 372, 'params': ['self', 'energy_operator', 'uniform_state'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'stopping_power_zero', 'line': 376, 'params': ['E'], 'complexity': 1, 'nesting_depth': 5}, {'name': 'test_deposited_energy_shape', 'line': 391, 'params': ['self', 'energy_operator', 'uniform_state', 'constant_stopping_power'], 'complexity': 1, 'nesting_depth': 3}] | [{'name': 'TestAngularScatteringOperator', 'line': 18, 'methods': ['test_initialization', 'test_compute_sigma_theta', 'test_compute_sigma_theta_low_energy', 'test_get_scattering_kernel_normalization', 'test_get_scattering_kernel_periodic_boundary', 'test_apply_conserves_weight', 'test_apply_preserves_positivity', 'test_apply_zero_state', 'test_apply_with_mid_policy', 'test_apply_unknown_policy']}, {'name': 'TestSpatialStreamingOperator', 'line': 134, 'methods': ['test_initialization', 'test_compute_step_size_forward_transport', 'test_check_backward_transport_hard_reject', 'test_check_backward_transport_forward', 'test_check_backward_transport_angular_cap', 'test_check_backward_transport_small_allowance', 'test_shift_and_deposit_inside_boundary', 'test_shift_and_deposit_outside_boundary', 'test_apply_conserves_or_accounts_weight', 'test_apply_preserves_positivity']}, {'name': 'TestEnergyLossOperator', 'line': 277, 'methods': ['test_initialization', 'test_apply_conserves_weight_below_cutoff', 'test_apply_absorbs_below_cutoff', 'test_apply_preserves_positivity', 'test_apply_energy_advection', 'test_apply_with_zero_stopping_power', 'test_deposited_energy_shape']}] | {'external': ['numpy', 'pytest', 'smatrix_2d']} | Tests for transport operators. | None | [{'caller': 'test_initialization', 'callee': 'pytest.approx'}, {'caller': 'test_compute_sigma_theta', 'callee': 'angular_operator.compute_sigma_theta'}, {'caller': 'test_compute_sigma_theta_low_energy', 'callee': 'angular_operator.compute_sigma_theta'}, {'caller': 'test_compute_sigma_theta_low_energy', 'callee': 'pytest.approx'}, {'caller': 'test_get_scattering_kernel_normalization', 'callee': 'sum'}, {'caller': 'test_get_scattering_kernel_normalization', 'callee': 'angular_operator.get_scattering_kernel'}, {'caller': 'test_get_scattering_kernel_normalization', 'callee': 'pytest.approx'}, {'caller': 'test_get_scattering_kernel_periodic_boundary', 'callee': 'len'}, {'caller': 'test_get_scattering_kernel_periodic_boundary', 'callee': 'angular_operator.get_scattering_kernel'}, {'caller': 'test_apply_conserves_weight', 'callee': 'assert_allclose'}, {'caller': 'test_apply_conserves_weight', 'callee': 'np.sum'}, {'caller': 'test_apply_conserves_weight', 'callee': 'angular_operator.apply'}, {'caller': 'test_apply_conserves_weight', 'callee': 'initial_state.psi.copy'}, {'caller': 'test_apply_preserves_positivity', 'callee': 'uniform_state.psi.copy'}, {'caller': 'test_apply_preserves_positivity', 'callee': 'np.all'}, {'caller': 'test_apply_preserves_positivity', 'callee': 'initial_state.psi.copy'}, {'caller': 'test_apply_preserves_positivity', 'callee': 'spatial_operator.apply'}, {'caller': 'test_apply_preserves_positivity', 'callee': 'angular_operator.apply'}, {'caller': 'test_apply_preserves_positivity', 'callee': 'energy_operator.apply'}, {'caller': 'test_apply_zero_state', 'callee': 'pytest.approx'}, {'caller': 'test_apply_zero_state', 'callee': 'np.zeros'}, {'caller': 'test_apply_zero_state', 'callee': 'np.all'}, {'caller': 'test_apply_zero_state', 'callee': 'len'}, {'caller': 'test_apply_zero_state', 'callee': 'np.zeros_like'}, {'caller': 'test_apply_zero_state', 'callee': 'angular_operator.apply'}, {'caller': 'test_apply_with_mid_policy', 'callee': 'assert_allclose'}, {'caller': 'test_apply_with_mid_policy', 'callee': 'np.sum'}, {'caller': 'test_apply_with_mid_policy', 'callee': 'angular_operator_mid_policy.apply'}, {'caller': 'test_apply_with_mid_policy', 'callee': 'initial_state.psi.copy'}, {'caller': 'test_apply_unknown_policy', 'callee': 'pytest.raises'}, {'caller': 'test_apply_unknown_policy', 'callee': 'angular_operator.apply'}, {'caller': 'test_compute_step_size_forward_transport', 'callee': 'spatial_operator.compute_step_size'}, {'caller': 'test_check_backward_transport_hard_reject', 'callee': 'np.cos'}, {'caller': 'test_check_backward_transport_hard_reject', 'callee': 'spatial_operator.check_backward_transport'}, {'caller': 'test_check_backward_transport_hard_reject', 'callee': 'pytest.approx'}, {'caller': 'test_check_backward_transport_forward', 'callee': 'np.cos'}, {'caller': 'test_check_backward_transport_forward', 'callee': 'spatial_operator.check_backward_transport'}, {'caller': 'test_check_backward_transport_forward', 'callee': 'pytest.approx'}, {'caller': 'test_check_backward_transport_angular_cap', 'callee': 'np.cos'}, {'caller': 'test_check_backward_transport_angular_cap', 'callee': 'pytest.approx'}, {'caller': 'test_check_backward_transport_angular_cap', 'callee': 'spatial_operator_angular_cap.check_backward_transport'}, {'caller': 'test_check_backward_transport_small_allowance', 'callee': 'np.cos'}, {'caller': 'test_check_backward_transport_small_allowance', 'callee': 'spatial_operator_allowance.check_backward_transport'}, {'caller': 'test_shift_and_deposit_inside_boundary', 'callee': 'len'}, {'caller': 'test_shift_and_deposit_inside_boundary', 'callee': 'spatial_operator.shift_and_deposit'}, {'caller': 'test_shift_and_deposit_inside_boundary', 'callee': 'pytest.approx'}, {'caller': 'test_shift_and_deposit_outside_boundary', 'callee': 'len'}, {'caller': 'test_shift_and_deposit_outside_boundary', 'callee': 'spatial_operator.shift_and_deposit'}, {'caller': 'test_shift_and_deposit_outside_boundary', 'callee': 'pytest.approx'}, {'caller': 'test_apply_conserves_or_accounts_weight', 'callee': 'assert_allclose'}, {'caller': 'test_apply_conserves_or_accounts_weight', 'callee': 'np.sum'}, {'caller': 'test_apply_conserves_or_accounts_weight', 'callee': 'uniform_state.psi.copy'}, {'caller': 'test_apply_conserves_or_accounts_weight', 'callee': 'spatial_operator.apply'}, {'caller': 'test_apply_conserves_weight_below_cutoff', 'callee': 'assert_allclose'}, {'caller': 'test_apply_conserves_weight_below_cutoff', 'callee': 'energy_operator.apply'}, {'caller': 'test_apply_conserves_weight_below_cutoff', 'callee': 'np.sum'}, {'caller': 'test_apply_conserves_weight_below_cutoff', 'callee': 'np.zeros_like'}, {'caller': 'test_apply_absorbs_below_cutoff', 'callee': 'energy_operator.apply'}, {'caller': 'test_apply_absorbs_below_cutoff', 'callee': 'len'}, {'caller': 'test_apply_absorbs_below_cutoff', 'callee': 'np.sum'}, {'caller': 'test_apply_absorbs_below_cutoff', 'callee': 'np.zeros'}, {'caller': 'test_apply_energy_advection', 'callee': 'np.zeros'}, {'caller': 'test_apply_energy_advection', 'callee': 'len'}, {'caller': 'test_apply_energy_advection', 'callee': 'np.zeros_like'}, {'caller': 'test_apply_energy_advection', 'callee': 'deposited.sum'}, {'caller': 'test_apply_energy_advection', 'callee': 'assert_allclose'}, {'caller': 'test_apply_energy_advection', 'callee': 'energy_operator.apply'}, {'caller': 'test_apply_energy_advection', 'callee': 'np.sum'}, {'caller': 'test_apply_with_zero_stopping_power', 'callee': 'pytest.approx'}, {'caller': 'test_apply_with_zero_stopping_power', 'callee': 'uniform_state.psi.copy'}, {'caller': 'test_apply_with_zero_stopping_power', 'callee': 'assert_allclose'}, {'caller': 'test_apply_with_zero_stopping_power', 'callee': 'energy_operator.apply'}, {'caller': 'test_apply_with_zero_stopping_power', 'callee': 'np.sum'}, {'caller': 'test_deposited_energy_shape', 'callee': 'energy_operator.apply'}, {'caller': 'test_deposited_energy_shape', 'callee': 'len'}, {'caller': 'test_deposited_energy_shape', 'callee': 'uniform_state.psi.copy'}]
      tests/test_core.py | python | [{'name': 'test_initialization', 'line': 22, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_default_theta_range', 'line': 41, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_invalid_cutoff_less_than_min', 'line': 52, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_invalid_negative_theta_range', 'line': 61, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_invalid_zero_theta_range', 'line': 72, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_invalid_negative_dimensions', 'line': 83, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_invalid_zero_dimensions', 'line': 92, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_uniform_energy_grid', 'line': 105, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_logarithmic_energy_grid', 'line': 120, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_range_based_grid_without_material_range', 'line': 137, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_range_based_grid_with_dummy_range', 'line': 148, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_unknown_grid_type', 'line': 165, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_energy_centers_are_midpoints', 'line': 175, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_grid_creation', 'line': 191, 'params': ['self', 'default_grid_specs'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_spatial_grid_boundaries', 'line': 205, 'params': ['self', 'default_grid_specs'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_angular_grid_boundaries', 'line': 217, 'params': ['self', 'default_grid_specs'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_delta_values', 'line': 224, 'params': ['self', 'grid'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_initialization', 'line': 235, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_invalid_negative_density', 'line': 253, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_invalid_zero_density', 'line': 265, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_invalid_negative_radiation_length', 'line': 277, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_invalid_negative_excitation_energy', 'line': 289, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_water_material_properties', 'line': 305, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_initialization', 'line': 320, 'params': ['self', 'grid'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_invalid_psi_shape', 'line': 334, 'params': ['self', 'grid'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_total_weight', 'line': 341, 'params': ['self', 'grid'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_total_dose', 'line': 352, 'params': ['self', 'grid'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_conservation_check_passes', 'line': 364, 'params': ['self', 'grid'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_conservation_check_with_sinks', 'line': 375, 'params': ['self', 'grid'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_conservation_check_fails', 'line': 405, 'params': ['self', 'grid'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_initial_state_creation', 'line': 420, 'params': ['self', 'grid'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_initial_state_total_weight', 'line': 437, 'params': ['self', 'grid'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_initial_state_default_weight', 'line': 450, 'params': ['self', 'grid'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_initial_state_finds_nearest_bins', 'line': 462, 'params': ['self', 'grid'], 'complexity': 1, 'nesting_depth': 3}] | [{'name': 'TestGridSpecs2D', 'line': 19, 'methods': ['test_initialization', 'test_default_theta_range', 'test_invalid_cutoff_less_than_min', 'test_invalid_negative_theta_range', 'test_invalid_zero_theta_range', 'test_invalid_negative_dimensions', 'test_invalid_zero_dimensions']}, {'name': 'TestCreateEnergyGrid', 'line': 102, 'methods': ['test_uniform_energy_grid', 'test_logarithmic_energy_grid', 'test_range_based_grid_without_material_range', 'test_range_based_grid_with_dummy_range', 'test_unknown_grid_type', 'test_energy_centers_are_midpoints']}, {'name': 'TestCreatePhaseSpaceGrid', 'line': 188, 'methods': ['test_grid_creation', 'test_spatial_grid_boundaries', 'test_angular_grid_boundaries', 'test_delta_values']}, {'name': 'TestMaterialProperties2D', 'line': 232, 'methods': ['test_initialization', 'test_invalid_negative_density', 'test_invalid_zero_density', 'test_invalid_negative_radiation_length', 'test_invalid_negative_excitation_energy']}, {'name': 'TestCreateWaterMaterial', 'line': 302, 'methods': ['test_water_material_properties']}, {'name': 'TestTransportState', 'line': 317, 'methods': ['test_initialization', 'test_invalid_psi_shape', 'test_total_weight', 'test_total_dose', 'test_conservation_check_passes', 'test_conservation_check_with_sinks', 'test_conservation_check_fails']}, {'name': 'TestCreateInitialState', 'line': 417, 'methods': ['test_initial_state_creation', 'test_initial_state_total_weight', 'test_initial_state_default_weight', 'test_initial_state_finds_nearest_bins']}] | {'external': ['numpy', 'pytest', 'smatrix_2d']} | Tests for core modules: grid, materials, state. | None | [{'caller': 'test_initialization', 'callee': 'np.zeros'}, {'caller': 'test_initialization', 'callee': 'GridSpecs2D'}, {'caller': 'test_initialization', 'callee': 'len'}, {'caller': 'test_initialization', 'callee': 'MaterialProperties2D'}, {'caller': 'test_initialization', 'callee': 'TransportState'}, {'caller': 'test_default_theta_range', 'callee': 'GridSpecs2D'}, {'caller': 'test_invalid_cutoff_less_than_min', 'callee': 'pytest.raises'}, {'caller': 'test_invalid_cutoff_less_than_min', 'callee': 'GridSpecs2D'}, {'caller': 'test_invalid_negative_theta_range', 'callee': 'pytest.raises'}, {'caller': 'test_invalid_negative_theta_range', 'callee': 'GridSpecs2D'}, {'caller': 'test_invalid_zero_theta_range', 'callee': 'pytest.raises'}, {'caller': 'test_invalid_zero_theta_range', 'callee': 'GridSpecs2D'}, {'caller': 'test_invalid_negative_dimensions', 'callee': 'pytest.raises'}, {'caller': 'test_invalid_negative_dimensions', 'callee': 'GridSpecs2D'}, {'caller': 'test_invalid_zero_dimensions', 'callee': 'pytest.raises'}, {'caller': 'test_invalid_zero_dimensions', 'callee': 'GridSpecs2D'}, {'caller': 'test_uniform_energy_grid', 'callee': 'assert_allclose'}, {'caller': 'test_uniform_energy_grid', 'callee': 'create_energy_grid'}, {'caller': 'test_uniform_energy_grid', 'callee': 'len'}, {'caller': 'test_uniform_energy_grid', 'callee': 'pytest.approx'}, {'caller': 'test_logarithmic_energy_grid', 'callee': 'assert_allclose'}, {'caller': 'test_logarithmic_energy_grid', 'callee': 'create_energy_grid'}, {'caller': 'test_logarithmic_energy_grid', 'callee': 'len'}, {'caller': 'test_logarithmic_energy_grid', 'callee': 'pytest.approx'}, {'caller': 'test_range_based_grid_without_material_range', 'callee': 'pytest.raises'}, {'caller': 'test_range_based_grid_without_material_range', 'callee': 'create_energy_grid'}, {'caller': 'test_range_based_grid_with_dummy_range', 'callee': 'create_energy_grid'}, {'caller': 'test_range_based_grid_with_dummy_range', 'callee': 'len'}, {'caller': 'test_range_based_grid_with_dummy_range', 'callee': 'np.linspace'}, {'caller': 'test_unknown_grid_type', 'callee': 'pytest.raises'}, {'caller': 'test_unknown_grid_type', 'callee': 'create_energy_grid'}, {'caller': 'test_energy_centers_are_midpoints', 'callee': 'assert_allclose'}, {'caller': 'test_energy_centers_are_midpoints', 'callee': 'create_energy_grid'}, {'caller': 'test_grid_creation', 'callee': 'len'}, {'caller': 'test_grid_creation', 'callee': 'create_phase_space_grid'}, {'caller': 'test_grid_creation', 'callee': 'isinstance'}, {'caller': 'test_spatial_grid_boundaries', 'callee': 'pytest.approx'}, {'caller': 'test_spatial_grid_boundaries', 'callee': 'create_phase_space_grid'}, {'caller': 'test_angular_grid_boundaries', 'callee': 'pytest.approx'}, {'caller': 'test_angular_grid_boundaries', 'callee': 'create_phase_space_grid'}, {'caller': 'test_delta_values', 'callee': 'pytest.approx'}, {'caller': 'test_invalid_negative_density', 'callee': 'pytest.raises'}, {'caller': 'test_invalid_negative_density', 'callee': 'MaterialProperties2D'}, {'caller': 'test_invalid_zero_density', 'callee': 'pytest.raises'}, {'caller': 'test_invalid_zero_density', 'callee': 'MaterialProperties2D'}, {'caller': 'test_invalid_negative_radiation_length', 'callee': 'pytest.raises'}, {'caller': 'test_invalid_negative_radiation_length', 'callee': 'MaterialProperties2D'}, {'caller': 'test_invalid_negative_excitation_energy', 'callee': 'pytest.raises'}, {'caller': 'test_invalid_negative_excitation_energy', 'callee': 'MaterialProperties2D'}, {'caller': 'test_water_material_properties', 'callee': 'create_water_material'}, {'caller': 'test_invalid_psi_shape', 'callee': 'pytest.raises'}, {'caller': 'test_invalid_psi_shape', 'callee': 'np.zeros'}, {'caller': 'test_invalid_psi_shape', 'callee': 'TransportState'}, {'caller': 'test_total_weight', 'callee': 'pytest.approx'}, {'caller': 'test_total_weight', 'callee': 'state.total_weight'}, {'caller': 'test_total_weight', 'callee': 'np.ones'}, {'caller': 'test_total_weight', 'callee': 'len'}, {'caller': 'test_total_weight', 'callee': 'TransportState'}, {'caller': 'test_total_weight', 'callee': 'np.sum'}, {'caller': 'test_total_dose', 'callee': 'pytest.approx'}, {'caller': 'test_total_dose', 'callee': 'np.zeros'}, {'caller': 'test_total_dose', 'callee': 'state.total_dose'}, {'caller': 'test_total_dose', 'callee': 'len'}, {'caller': 'test_total_dose', 'callee': 'np.ones'}, {'caller': 'test_total_dose', 'callee': 'TransportState'}, {'caller': 'test_total_dose', 'callee': 'np.sum'}, {'caller': 'test_conservation_check_passes', 'callee': 'state.total_weight'}, {'caller': 'test_conservation_check_passes', 'callee': 'np.ones'}, {'caller': 'test_conservation_check_passes', 'callee': 'len'}, {'caller': 'test_conservation_check_passes', 'callee': 'state.conservation_check'}, {'caller': 'test_conservation_check_passes', 'callee': 'TransportState'}, {'caller': 'test_conservation_check_with_sinks', 'callee': 'state.total_weight'}, {'caller': 'test_conservation_check_with_sinks', 'callee': 'np.ones'}, {'caller': 'test_conservation_check_with_sinks', 'callee': 'len'}, {'caller': 'test_conservation_check_with_sinks', 'callee': 'state.conservation_check'}, {'caller': 'test_conservation_check_with_sinks', 'callee': 'abs'}, {'caller': 'test_conservation_check_with_sinks', 'callee': 'TransportState'}, {'caller': 'test_conservation_check_fails', 'callee': 'state.total_weight'}, {'caller': 'test_conservation_check_fails', 'callee': 'np.ones'}, {'caller': 'test_conservation_check_fails', 'callee': 'len'}, {'caller': 'test_conservation_check_fails', 'callee': 'state.conservation_check'}, {'caller': 'test_conservation_check_fails', 'callee': 'TransportState'}, {'caller': 'test_initial_state_creation', 'callee': 'np.sum'}, {'caller': 'test_initial_state_creation', 'callee': 'pytest.approx'}, {'caller': 'test_initial_state_creation', 'callee': 'create_initial_state'}, {'caller': 'test_initial_state_total_weight', 'callee': 'pytest.approx'}, {'caller': 'test_initial_state_total_weight', 'callee': 'create_initial_state'}, {'caller': 'test_initial_state_total_weight', 'callee': 'state.total_weight'}, {'caller': 'test_initial_state_default_weight', 'callee': 'pytest.approx'}, {'caller': 'test_initial_state_default_weight', 'callee': 'create_initial_state'}, {'caller': 'test_initial_state_default_weight', 'callee': 'state.total_weight'}, {'caller': 'test_initial_state_finds_nearest_bins', 'callee': 'pytest.approx'}, {'caller': 'test_initial_state_finds_nearest_bins', 'callee': 'create_initial_state'}]
      tests/test_integration.py | python | [{'name': 'test_complete_transport_simulation', 'line': 14, 'params': ['self', 'first_order_transport', 'grid', 'constant_stopping_power'], 'complexity': 4, 'nesting_depth': 3}, {'name': 'test_transport_with_scattering', 'line': 61, 'params': ['self', 'first_order_transport', 'grid', 'constant_stopping_power'], 'complexity': 2, 'nesting_depth': 3}, {'name': 'test_transport_with_energy_loss', 'line': 95, 'params': ['self', 'first_order_transport', 'grid', 'constant_stopping_power'], 'complexity': 2, 'nesting_depth': 3}, {'name': 'test_transport_oblique_beam', 'line': 129, 'params': ['self', 'first_order_transport', 'grid', 'constant_stopping_power'], 'complexity': 2, 'nesting_depth': 3}, {'name': 'test_transport_positivity_preservation', 'line': 163, 'params': ['self', 'first_order_transport', 'grid', 'constant_stopping_power'], 'complexity': 2, 'nesting_depth': 3}, {'name': 'test_transport_consistency_check', 'line': 188, 'params': ['self', 'first_order_transport', 'grid', 'constant_stopping_power'], 'complexity': 2, 'nesting_depth': 3}, {'name': 'test_transport_with_zero_initial_weight', 'line': 214, 'params': ['self', 'first_order_transport', 'grid'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'stopping_power', 'line': 225, 'params': ['E'], 'complexity': 1, 'nesting_depth': 5}, {'name': 'test_transport_at_boundary', 'line': 233, 'params': ['self', 'first_order_transport', 'grid', 'constant_stopping_power'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_transport_very_low_energy', 'line': 263, 'params': ['self', 'first_order_transport', 'grid', 'constant_stopping_power'], 'complexity': 2, 'nesting_depth': 3}] | [{'name': 'TestFullTransportPipeline', 'line': 11, 'methods': ['test_complete_transport_simulation', 'test_transport_with_scattering', 'test_transport_with_energy_loss', 'test_transport_oblique_beam', 'test_transport_positivity_preservation', 'test_transport_consistency_check']}, {'name': 'TestEdgeCases', 'line': 211, 'methods': ['test_transport_with_zero_initial_weight', 'test_transport_at_boundary', 'test_transport_very_low_energy']}] | {'external': ['numpy', 'pytest', 'smatrix_2d']} | Integration tests for full transport pipeline. | None | [{'caller': 'test_complete_transport_simulation', 'callee': 'range'}, {'caller': 'test_complete_transport_simulation', 'callee': 'state.total_weight'}, {'caller': 'test_complete_transport_simulation', 'callee': 'state.total_dose'}, {'caller': 'test_complete_transport_simulation', 'callee': 'len'}, {'caller': 'test_complete_transport_simulation', 'callee': 'first_order_transport.apply'}, {'caller': 'test_complete_transport_simulation', 'callee': 'assert_allclose'}, {'caller': 'test_complete_transport_simulation', 'callee': 'create_initial_state'}, {'caller': 'test_transport_with_scattering', 'callee': 'range'}, {'caller': 'test_transport_with_scattering', 'callee': 'state.total_weight'}, {'caller': 'test_transport_with_scattering', 'callee': 'len'}, {'caller': 'test_transport_with_scattering', 'callee': 'first_order_transport.apply'}, {'caller': 'test_transport_with_scattering', 'callee': 'assert_allclose'}, {'caller': 'test_transport_with_scattering', 'callee': 'np.sum'}, {'caller': 'test_transport_with_scattering', 'callee': 'create_initial_state'}, {'caller': 'test_transport_with_energy_loss', 'callee': 'range'}, {'caller': 'test_transport_with_energy_loss', 'callee': 'state.total_weight'}, {'caller': 'test_transport_with_energy_loss', 'callee': 'len'}, {'caller': 'test_transport_with_energy_loss', 'callee': 'first_order_transport.apply'}, {'caller': 'test_transport_with_energy_loss', 'callee': 'assert_allclose'}, {'caller': 'test_transport_with_energy_loss', 'callee': 'create_initial_state'}, {'caller': 'test_transport_oblique_beam', 'callee': 'range'}, {'caller': 'test_transport_oblique_beam', 'callee': 'state.total_weight'}, {'caller': 'test_transport_oblique_beam', 'callee': 'len'}, {'caller': 'test_transport_oblique_beam', 'callee': 'first_order_transport.apply'}, {'caller': 'test_transport_oblique_beam', 'callee': 'assert_allclose'}, {'caller': 'test_transport_oblique_beam', 'callee': 'np.sum'}, {'caller': 'test_transport_oblique_beam', 'callee': 'create_initial_state'}, {'caller': 'test_transport_positivity_preservation', 'callee': 'range'}, {'caller': 'test_transport_positivity_preservation', 'callee': 'np.all'}, {'caller': 'test_transport_positivity_preservation', 'callee': 'len'}, {'caller': 'test_transport_positivity_preservation', 'callee': 'first_order_transport.apply'}, {'caller': 'test_transport_positivity_preservation', 'callee': 'create_initial_state'}, {'caller': 'test_transport_consistency_check', 'callee': 'range'}, {'caller': 'test_transport_consistency_check', 'callee': 'state.total_weight'}, {'caller': 'test_transport_consistency_check', 'callee': 'len'}, {'caller': 'test_transport_consistency_check', 'callee': 'first_order_transport.apply'}, {'caller': 'test_transport_consistency_check', 'callee': 'state.conservation_check'}, {'caller': 'test_transport_consistency_check', 'callee': 'create_initial_state'}, {'caller': 'test_transport_with_zero_initial_weight', 'callee': 'pytest.approx'}, {'caller': 'test_transport_with_zero_initial_weight', 'callee': 'state.total_weight'}, {'caller': 'test_transport_with_zero_initial_weight', 'callee': 'np.zeros'}, {'caller': 'test_transport_with_zero_initial_weight', 'callee': 'first_order_transport.apply'}, {'caller': 'test_transport_with_zero_initial_weight', 'callee': 'len'}, {'caller': 'test_transport_with_zero_initial_weight', 'callee': 'TransportState'}, {'caller': 'test_transport_at_boundary', 'callee': 'state.total_weight'}, {'caller': 'test_transport_at_boundary', 'callee': 'len'}, {'caller': 'test_transport_at_boundary', 'callee': 'first_order_transport.apply'}, {'caller': 'test_transport_at_boundary', 'callee': 'assert_allclose'}, {'caller': 'test_transport_at_boundary', 'callee': 'create_initial_state'}, {'caller': 'test_transport_very_low_energy', 'callee': 'range'}, {'caller': 'test_transport_very_low_energy', 'callee': 'state.total_weight'}, {'caller': 'test_transport_very_low_energy', 'callee': 'len'}, {'caller': 'test_transport_very_low_energy', 'callee': 'first_order_transport.apply'}, {'caller': 'test_transport_very_low_energy', 'callee': 'assert_allclose'}, {'caller': 'test_transport_very_low_energy', 'callee': 'create_initial_state'}]
      tests/test_transport.py | python | [{'name': 'test_initialization', 'line': 18, 'params': ['self', 'first_order_transport', 'angular_operator', 'spatial_operator', 'energy_operator'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_apply_first_order_conserves_weight', 'line': 28, 'params': ['self', 'first_order_transport', 'initial_state', 'constant_stopping_power'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_apply_strang_conserves_weight', 'line': 47, 'params': ['self', 'strang_transport', 'initial_state', 'constant_stopping_power'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_apply_preserves_positivity', 'line': 66, 'params': ['self', 'first_order_transport', 'initial_state', 'constant_stopping_power'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_apply_updates_dose', 'line': 74, 'params': ['self', 'first_order_transport', 'initial_state', 'constant_stopping_power'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_apply_multiple_steps', 'line': 87, 'params': ['self', 'first_order_transport', 'initial_state', 'constant_stopping_power'], 'complexity': 2, 'nesting_depth': 3}, {'name': 'test_apply_unknown_splitting_type', 'line': 108, 'params': ['self', 'angular_operator', 'spatial_operator', 'energy_operator', 'initial_state', 'constant_stopping_power'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_first_order_splitting_factory', 'line': 125, 'params': ['self', 'angular_operator', 'spatial_operator', 'energy_operator'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_strang_splitting_factory', 'line': 136, 'params': ['self', 'angular_operator', 'spatial_operator', 'energy_operator'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_vacuum_conserves_weight', 'line': 151, 'params': ['self', 'grid', 'angular_operator', 'spatial_operator', 'energy_operator'], 'complexity': 2, 'nesting_depth': 3}, {'name': 'stopping_power_vac', 'line': 186, 'params': ['E'], 'complexity': 1, 'nesting_depth': 5}] | [{'name': 'TestTransportStep', 'line': 15, 'methods': ['test_initialization', 'test_apply_first_order_conserves_weight', 'test_apply_strang_conserves_weight', 'test_apply_preserves_positivity', 'test_apply_updates_dose', 'test_apply_multiple_steps', 'test_apply_unknown_splitting_type']}, {'name': 'TestSplittingMethods', 'line': 122, 'methods': ['test_first_order_splitting_factory', 'test_strang_splitting_factory']}, {'name': 'TestVacuumTransport', 'line': 148, 'methods': ['test_vacuum_conserves_weight']}] | {'external': ['numpy', 'pytest', 'smatrix_2d']} | Tests for transport orchestration. | None | [{'caller': 'test_apply_first_order_conserves_weight', 'callee': 'assert_allclose'}, {'caller': 'test_apply_first_order_conserves_weight', 'callee': 'first_order_transport.apply'}, {'caller': 'test_apply_first_order_conserves_weight', 'callee': 'state.total_weight'}, {'caller': 'test_apply_first_order_conserves_weight', 'callee': 'initial_state.total_weight'}, {'caller': 'test_apply_strang_conserves_weight', 'callee': 'assert_allclose'}, {'caller': 'test_apply_strang_conserves_weight', 'callee': 'state.total_weight'}, {'caller': 'test_apply_strang_conserves_weight', 'callee': 'initial_state.total_weight'}, {'caller': 'test_apply_strang_conserves_weight', 'callee': 'strang_transport.apply'}, {'caller': 'test_apply_preserves_positivity', 'callee': 'first_order_transport.apply'}, {'caller': 'test_apply_preserves_positivity', 'callee': 'np.all'}, {'caller': 'test_apply_updates_dose', 'callee': 'initial_state.total_dose'}, {'caller': 'test_apply_updates_dose', 'callee': 'first_order_transport.apply'}, {'caller': 'test_apply_updates_dose', 'callee': 'state.total_dose'}, {'caller': 'test_apply_multiple_steps', 'callee': 'assert_allclose'}, {'caller': 'test_apply_multiple_steps', 'callee': 'first_order_transport.apply'}, {'caller': 'test_apply_multiple_steps', 'callee': 'range'}, {'caller': 'test_apply_multiple_steps', 'callee': 'state.total_weight'}, {'caller': 'test_apply_unknown_splitting_type', 'callee': 'pytest.raises'}, {'caller': 'test_apply_unknown_splitting_type', 'callee': 'transport.apply'}, {'caller': 'test_apply_unknown_splitting_type', 'callee': 'TransportStep'}, {'caller': 'test_first_order_splitting_factory', 'callee': 'isinstance'}, {'caller': 'test_first_order_splitting_factory', 'callee': 'FirstOrderSplitting'}, {'caller': 'test_strang_splitting_factory', 'callee': 'StrangSplitting'}, {'caller': 'test_strang_splitting_factory', 'callee': 'isinstance'}, {'caller': 'test_vacuum_conserves_weight', 'callee': 'AngularScatteringOperator'}, {'caller': 'test_vacuum_conserves_weight', 'callee': 'range'}, {'caller': 'test_vacuum_conserves_weight', 'callee': 'state.total_weight'}, {'caller': 'test_vacuum_conserves_weight', 'callee': 'len'}, {'caller': 'test_vacuum_conserves_weight', 'callee': 'MaterialProperties2D'}, {'caller': 'test_vacuum_conserves_weight', 'callee': 'assert_allclose'}, {'caller': 'test_vacuum_conserves_weight', 'callee': 'transport.apply'}, {'caller': 'test_vacuum_conserves_weight', 'callee': 'create_initial_state'}, {'caller': 'test_vacuum_conserves_weight', 'callee': 'EnergyLossOperator'}, {'caller': 'test_vacuum_conserves_weight', 'callee': 'FirstOrderSplitting'}]
      tests/conftest.py | python | [{'name': 'default_grid_specs', 'line': 20, 'params': [], 'complexity': 1, 'nesting_depth': 2}, {'name': 'small_grid_specs', 'line': 37, 'params': [], 'complexity': 1, 'nesting_depth': 2}, {'name': 'grid', 'line': 54, 'params': ['default_grid_specs'], 'complexity': 1, 'nesting_depth': 2}, {'name': 'small_grid', 'line': 60, 'params': ['small_grid_specs'], 'complexity': 1, 'nesting_depth': 2}, {'name': 'material', 'line': 66, 'params': [], 'complexity': 1, 'nesting_depth': 2}, {'name': 'constants', 'line': 72, 'params': [], 'complexity': 1, 'nesting_depth': 2}, {'name': 'initial_state', 'line': 78, 'params': ['grid'], 'complexity': 1, 'nesting_depth': 2}, {'name': 'state_multiple_particles', 'line': 91, 'params': ['grid'], 'complexity': 1, 'nesting_depth': 2}, {'name': 'uniform_state', 'line': 102, 'params': ['grid'], 'complexity': 1, 'nesting_depth': 2}, {'name': 'angular_operator', 'line': 116, 'params': ['grid', 'material', 'constants'], 'complexity': 1, 'nesting_depth': 2}, {'name': 'angular_operator_mid_policy', 'line': 122, 'params': ['grid', 'material', 'constants'], 'complexity': 1, 'nesting_depth': 2}, {'name': 'spatial_operator', 'line': 131, 'params': ['grid', 'constants'], 'complexity': 1, 'nesting_depth': 2}, {'name': 'spatial_operator_angular_cap', 'line': 140, 'params': ['grid', 'constants'], 'complexity': 1, 'nesting_depth': 2}, {'name': 'spatial_operator_allowance', 'line': 149, 'params': ['grid', 'constants'], 'complexity': 1, 'nesting_depth': 2}, {'name': 'energy_operator', 'line': 159, 'params': ['grid'], 'complexity': 1, 'nesting_depth': 2}, {'name': 'first_order_transport', 'line': 168, 'params': ['angular_operator', 'spatial_operator', 'energy_operator'], 'complexity': 1, 'nesting_depth': 2}, {'name': 'strang_transport', 'line': 174, 'params': ['angular_operator', 'spatial_operator', 'energy_operator'], 'complexity': 1, 'nesting_depth': 2}, {'name': 'constant_stopping_power', 'line': 183, 'params': [], 'complexity': 1, 'nesting_depth': 2}, {'name': 'stopping_power', 'line': 185, 'params': ['E_MeV'], 'complexity': 1, 'nesting_depth': 4}, {'name': 'linear_stopping_power', 'line': 191, 'params': [], 'complexity': 1, 'nesting_depth': 2}, {'name': 'stopping_power', 'line': 193, 'params': ['E_MeV'], 'complexity': 1, 'nesting_depth': 4}, {'name': 'vacuum_stopping_power', 'line': 199, 'params': [], 'complexity': 1, 'nesting_depth': 2}, {'name': 'stopping_power', 'line': 201, 'params': ['E_MeV'], 'complexity': 1, 'nesting_depth': 4}, {'name': 'tolerance', 'line': 210, 'params': [], 'complexity': 1, 'nesting_depth': 2}, {'name': 'rtol', 'line': 216, 'params': [], 'complexity': 1, 'nesting_depth': 2}, {'name': 'atol', 'line': 222, 'params': [], 'complexity': 1, 'nesting_depth': 2}, {'name': 'step_size', 'line': 228, 'params': ['grid'], 'complexity': 1, 'nesting_depth': 2}] | [] | {'external': ['numpy', 'pytest', 'smatrix_2d']} | Pytest configuration and shared fixtures for Smatrix_2D tests. | None | [{'caller': 'default_grid_specs', 'callee': 'GridSpecs2D'}, {'caller': 'small_grid_specs', 'callee': 'GridSpecs2D'}, {'caller': 'grid', 'callee': 'create_phase_space_grid'}, {'caller': 'small_grid', 'callee': 'create_phase_space_grid'}, {'caller': 'material', 'callee': 'create_water_material'}, {'caller': 'constants', 'callee': 'PhysicsConstants2D'}, {'caller': 'initial_state', 'callee': 'len'}, {'caller': 'initial_state', 'callee': 'create_initial_state'}, {'caller': 'state_multiple_particles', 'callee': 'np.ones'}, {'caller': 'state_multiple_particles', 'callee': 'len'}, {'caller': 'state_multiple_particles', 'callee': 'TransportState'}, {'caller': 'uniform_state', 'callee': 'np.ones'}, {'caller': 'uniform_state', 'callee': 'len'}, {'caller': 'uniform_state', 'callee': 'TransportState'}, {'caller': 'angular_operator', 'callee': 'AngularScatteringOperator'}, {'caller': 'angular_operator_mid_policy', 'callee': 'AngularScatteringOperator'}, {'caller': 'spatial_operator', 'callee': 'SpatialStreamingOperator'}, {'caller': 'spatial_operator_angular_cap', 'callee': 'SpatialStreamingOperator'}, {'caller': 'spatial_operator_allowance', 'callee': 'SpatialStreamingOperator'}, {'caller': 'energy_operator', 'callee': 'EnergyLossOperator'}, {'caller': 'first_order_transport', 'callee': 'FirstOrderSplitting'}, {'caller': 'strang_transport', 'callee': 'StrangSplitting'}]
      smatrix_2d/core/constants.py | python | [] | [{'name': 'PhysicsConstants2D', 'line': 6, 'methods': []}] | {'stdlib': ['dataclasses']} | Physics constants for 2D transport system. | None | []
      smatrix_2d/core/grid.py | python | [{'name': '__post_init__', 'line': 59, 'params': ['self'], 'complexity': 7, 'nesting_depth': 4}, {'name': 'create_energy_grid', 'line': 117, 'params': [], 'complexity': 5, 'nesting_depth': 1}, {'name': 'create_phase_space_grid', 'line': 162, 'params': [], 'complexity': 1, 'nesting_depth': 1}] | [{'name': 'EnergyGridType', 'line': 16, 'methods': []}, {'name': 'GridSpecs2D', 'line': 24, 'methods': ['__post_init__']}, {'name': 'PhaseSpaceGrid2D', 'line': 80, 'methods': []}] | {'stdlib': ['dataclasses', 'enum', 'typing'], 'external': ['numpy']} | Grid specifications and phase space definitions for operator-factorized transport. | None | [{'caller': '__post_init__', 'callee': 'ValueError'}, {'caller': 'create_energy_grid', 'callee': 'ValueError'}, {'caller': 'create_energy_grid', 'callee': 'np.log10'}, {'caller': 'create_energy_grid', 'callee': 'np.linspace'}, {'caller': 'create_energy_grid', 'callee': 'np.logspace'}, {'caller': 'create_phase_space_grid', 'callee': 'create_energy_grid'}, {'caller': 'create_phase_space_grid', 'callee': 'PhaseSpaceGrid2D'}, {'caller': 'create_phase_space_grid', 'callee': 'np.linspace'}]
      smatrix_2d/core/materials.py | python | [{'name': '__post_init__', 'line': 29, 'params': ['self'], 'complexity': 4, 'nesting_depth': 4}, {'name': 'create_water_material', 'line': 41, 'params': [], 'complexity': 1, 'nesting_depth': 1}] | [{'name': 'MaterialProperties2D', 'line': 10, 'methods': ['__post_init__']}] | {'stdlib': ['dataclasses']} | Material properties for 2D transport. | None | [{'caller': '__post_init__', 'callee': 'ValueError'}, {'caller': 'create_water_material', 'callee': 'MaterialProperties2D'}]
      smatrix_2d/core/__init__.py | python | [] | [] | {'external': ['smatrix_2d']} | Core data structures for operator-factorized 2D transport. | None | []
      smatrix_2d/core/state.py | python | [{'name': '__post_init__', 'line': 45, 'params': ['self'], 'complexity': 3, 'nesting_depth': 4}, {'name': 'total_weight', 'line': 65, 'params': ['self'], 'complexity': 1, 'nesting_depth': 4}, {'name': 'total_dose', 'line': 69, 'params': ['self'], 'complexity': 1, 'nesting_depth': 4}, {'name': 'conservation_check', 'line': 73, 'params': ['self'], 'complexity': 1, 'nesting_depth': 4}, {'name': 'create_initial_state', 'line': 96, 'params': [], 'complexity': 1, 'nesting_depth': 1}] | [{'name': 'TransportState', 'line': 18, 'methods': ['__post_init__', 'total_weight', 'total_dose', 'conservation_check']}] | {'stdlib': ['dataclasses', 'typing'], 'external': ['numpy', 'smatrix_2d']} | Transport state management for 4D phase space. | None | [{'caller': '__post_init__', 'callee': 'len'}, {'caller': '__post_init__', 'callee': 'ValueError'}, {'caller': '__post_init__', 'callee': 'np.zeros'}, {'caller': 'total_weight', 'callee': 'np.sum'}, {'caller': 'total_dose', 'callee': 'np.sum'}, {'caller': 'conservation_check', 'callee': 'abs'}, {'caller': 'conservation_check', 'callee': 'bool'}, {'caller': 'conservation_check', 'callee': 'self.total_weight'}, {'caller': 'create_initial_state', 'callee': 'np.zeros'}, {'caller': 'create_initial_state', 'callee': 'len'}, {'caller': 'create_initial_state', 'callee': 'np.argmin'}, {'caller': 'create_initial_state', 'callee': 'TransportState'}, {'caller': 'create_initial_state', 'callee': 'np.abs'}]
      smatrix_2d/gpu/__init__.py | python | [] | [] | {'external': ['cupy', 'smatrix_2d']} | GPU acceleration package. | None | []
      smatrix_2d/gpu/kernels.py | python | [{'name': '__init__', 'line': 39, 'params': ['self'], 'complexity': 2, 'nesting_depth': 3}, {'name': '_angular_scattering_kernel', 'line': 68, 'params': ['self', 'psi_in'], 'complexity': 4, 'nesting_depth': 3}, {'name': '_spatial_streaming_kernel', 'line': 106, 'params': ['self', 'psi_in'], 'complexity': 14, 'nesting_depth': 3}, {'name': '_energy_loss_kernel', 'line': 162, 'params': ['self', 'psi', 'E_grid', 'stopping_power'], 'complexity': 10, 'nesting_depth': 3}, {'name': 'apply_step', 'line': 231, 'params': ['self', 'psi', 'E_grid', 'stopping_power'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'create_gpu_transport_step', 'line': 271, 'params': [], 'complexity': 1, 'nesting_depth': 1}] | [{'name': 'AccumulationMode', 'line': 23, 'methods': []}, {'name': 'GPUTransportStep', 'line': 29, 'methods': ['__init__', '_angular_scattering_kernel', '_spatial_streaming_kernel', '_energy_loss_kernel', 'apply_step']}] | {'stdlib': ['typing'], 'external': ['cupy', 'numpy']} | GPU kernels for operator-factorized transport using Numba/CuPy. | None | [{'caller': '__init__', 'callee': 'RuntimeError'}, {'caller': '_angular_scattering_kernel', 'callee': 'range'}, {'caller': '_angular_scattering_kernel', 'callee': 'cp.exp'}, {'caller': '_angular_scattering_kernel', 'callee': 'cp.arange'}, {'caller': '_angular_scattering_kernel', 'callee': 'theta_centers.mean'}, {'caller': '_angular_scattering_kernel', 'callee': 'cp.zeros_like'}, {'caller': '_angular_scattering_kernel', 'callee': 'kernel.sum'}, {'caller': '_angular_scattering_kernel', 'callee': 'cp.fft.ifft'}, {'caller': '_angular_scattering_kernel', 'callee': 'cp.fft.fft'}, {'caller': '_spatial_streaming_kernel', 'callee': 'int'}, {'caller': '_spatial_streaming_kernel', 'callee': 'cp.cos'}, {'caller': '_spatial_streaming_kernel', 'callee': 'range'}, {'caller': '_spatial_streaming_kernel', 'callee': 'cp.zeros_like'}, {'caller': '_spatial_streaming_kernel', 'callee': 'cp.sin'}, {'caller': '_spatial_streaming_kernel', 'callee': 'cp.array'}, {'caller': '_spatial_streaming_kernel', 'callee': 'cp.atomic.add'}, {'caller': '_energy_loss_kernel', 'callee': 'range'}, {'caller': '_energy_loss_kernel', 'callee': 'max'}, {'caller': '_energy_loss_kernel', 'callee': 'cp.zeros_like'}, {'caller': '_energy_loss_kernel', 'callee': 'cp.zeros'}, {'caller': '_energy_loss_kernel', 'callee': 'cp.searchsorted'}, {'caller': '_energy_loss_kernel', 'callee': 'cp.atomic.add'}, {'caller': '_energy_loss_kernel', 'callee': 'cp.sum'}, {'caller': 'apply_step', 'callee': 'self._spatial_streaming_kernel'}, {'caller': 'apply_step', 'callee': 'self._energy_loss_kernel'}, {'caller': 'apply_step', 'callee': 'self._angular_scattering_kernel'}, {'caller': 'create_gpu_transport_step', 'callee': 'GPUTransportStep'}]
      smatrix_2d/gpu/memory_layout.py | python | [{'name': '__init__', 'line': 27, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': '_compute_strides', 'line': 50, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'get_byte_size', 'line': 63, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'estimate_tile_size', 'line': 75, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'compute_suggested_block_config', 'line': 96, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'check_coalescing_access', 'line': 117, 'params': ['self'], 'complexity': 5, 'nesting_depth': 3}, {'name': 'create_gpu_memory_layout', 'line': 149, 'params': [], 'complexity': 1, 'nesting_depth': 1}] | [{'name': 'GPUMemoryLayout', 'line': 11, 'methods': ['__init__', '_compute_strides', 'get_byte_size', 'estimate_tile_size', 'compute_suggested_block_config', 'check_coalescing_access']}] | {'stdlib': ['typing'], 'external': ['numpy']} | GPU memory layout management for operator-factorized transport. | None | [{'caller': '__init__', 'callee': 'self._compute_strides'}, {'caller': 'get_byte_size', 'callee': 'np.dtype'}, {'caller': 'compute_suggested_block_config', 'callee': 'min'}, {'caller': 'create_gpu_memory_layout', 'callee': 'GPUMemoryLayout'}]
      smatrix_2d/validation/tests.py | python | [{'name': '__init__', 'line': 37, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'check_conservation', 'line': 65, 'params': ['self'], 'complexity': 2, 'nesting_depth': 3}, {'name': 'check_positivity', 'line': 93, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}, {'name': 'test_vacuum_transport', 'line': 111, 'params': ['self'], 'complexity': 4, 'nesting_depth': 3}, {'name': 'stopping_power_vac', 'line': 159, 'params': ['E'], 'complexity': 1, 'nesting_depth': 5}, {'name': 'test_rotational_invariance', 'line': 204, 'params': ['self'], 'complexity': 4, 'nesting_depth': 3}, {'name': 'stopping_power', 'line': 233, 'params': ['E'], 'complexity': 1, 'nesting_depth': 5}, {'name': 'run_all_tests', 'line': 277, 'params': ['self'], 'complexity': 1, 'nesting_depth': 3}] | [{'name': 'TransportValidator', 'line': 27, 'methods': ['__init__', 'check_conservation', 'check_positivity', 'test_vacuum_transport', 'test_rotational_invariance', 'run_all_tests']}] | {'external': ['numpy', 'smatrix_2d']} | Validation test suite for operator-factorized transport. | None | [{'caller': '__init__', 'callee': 'AngularScatteringOperator'}, {'caller': '__init__', 'callee': 'SpatialStreamingOperator'}, {'caller': '__init__', 'callee': 'EnergyLossOperator'}, {'caller': '__init__', 'callee': 'FirstOrderSplitting'}, {'caller': 'check_conservation', 'callee': 'abs'}, {'caller': 'check_conservation', 'callee': 'np.sum'}, {'caller': 'check_positivity', 'callee': 'np.all'}, {'caller': 'test_vacuum_transport', 'callee': 'AngularScatteringOperator'}, {'caller': 'test_vacuum_transport', 'callee': 'create_initial_state'}, {'caller': 'test_vacuum_transport', 'callee': 'range'}, {'caller': 'test_vacuum_transport', 'callee': 'state.total_weight'}, {'caller': 'test_vacuum_transport', 'callee': 'SpatialStreamingOperator'}, {'caller': 'test_vacuum_transport', 'callee': 'MaterialProperties2D'}, {'caller': 'test_vacuum_transport', 'callee': 'len'}, {'caller': 'test_vacuum_transport', 'callee': 'np.std'}, {'caller': 'test_vacuum_transport', 'callee': 'abs'}, {'caller': 'test_vacuum_transport', 'callee': 'x_centroid.append'}, {'caller': 'test_vacuum_transport', 'callee': 'z_centroid.append'}, {'caller': 'test_vacuum_transport', 'callee': 'transport_vac.apply'}, {'caller': 'test_vacuum_transport', 'callee': 'np.sin'}, {'caller': 'test_vacuum_transport', 'callee': 'np.cos'}, {'caller': 'test_vacuum_transport', 'callee': 'np.sum'}, {'caller': 'test_vacuum_transport', 'callee': 'EnergyLossOperator'}, {'caller': 'test_vacuum_transport', 'callee': 'FirstOrderSplitting'}, {'caller': 'test_rotational_invariance', 'callee': 'check_rotational_invariance'}, {'caller': 'test_rotational_invariance', 'callee': 'range'}, {'caller': 'test_rotational_invariance', 'callee': 'len'}, {'caller': 'test_rotational_invariance', 'callee': 'compute_gamma_pass_rate'}, {'caller': 'test_rotational_invariance', 'callee': 'self.transport.apply'}, {'caller': 'test_rotational_invariance', 'callee': 'create_initial_state'}, {'caller': 'run_all_tests', 'callee': 'self.test_rotational_invariance'}, {'caller': 'run_all_tests', 'callee': 'r.get'}, {'caller': 'run_all_tests', 'callee': 'self.test_vacuum_transport'}, {'caller': 'run_all_tests', 'callee': 'sum'}, {'caller': 'run_all_tests', 'callee': 'len'}, {'caller': 'run_all_tests', 'callee': 'results.values'}]
      smatrix_2d/validation/__init__.py | python | [] | [] | {'external': ['smatrix_2d']} | Validation package. | None | []
      smatrix_2d/validation/metrics.py | python | [{'name': 'compute_l2_norm', 'line': 11, 'params': [], 'complexity': 2, 'nesting_depth': 1}, {'name': 'compute_linf_norm', 'line': 42, 'params': [], 'complexity': 2, 'nesting_depth': 1}, {'name': '_compute_gamma_for_point', 'line': 73, 'params': [], 'complexity': 5, 'nesting_depth': 1}, {'name': 'compute_gamma_pass_rate', 'line': 127, 'params': [], 'complexity': 6, 'nesting_depth': 1}, {'name': 'check_rotational_invariance', 'line': 176, 'params': [], 'complexity': 6, 'nesting_depth': 1}, {'name': 'compute_convergence_order', 'line': 230, 'params': [], 'complexity': 1, 'nesting_depth': 1}] | [] | {'stdlib': ['typing'], 'external': ['numpy', 'scipy']} | Validation metrics for transport system. | None | [{'caller': 'compute_l2_norm', 'callee': 'np.sum'}, {'caller': 'compute_l2_norm', 'callee': 'np.sqrt'}, {'caller': 'compute_linf_norm', 'callee': 'np.abs'}, {'caller': 'compute_linf_norm', 'callee': 'np.max'}, {'caller': '_compute_gamma_for_point', 'callee': 'range'}, {'caller': '_compute_gamma_for_point', 'callee': 'max'}, {'caller': '_compute_gamma_for_point', 'callee': 'min'}, {'caller': '_compute_gamma_for_point', 'callee': 'abs'}, {'caller': '_compute_gamma_for_point', 'callee': 'np.sqrt'}, {'caller': 'compute_gamma_pass_rate', 'callee': 'np.sum'}, {'caller': 'compute_gamma_pass_rate', 'callee': 'range'}, {'caller': 'compute_gamma_pass_rate', 'callee': '_compute_gamma_for_point'}, {'caller': 'check_rotational_invariance', 'callee': 'range'}, {'caller': 'check_rotational_invariance', 'callee': 'compute_l2_norm'}, {'caller': 'check_rotational_invariance', 'callee': 'np.zeros_like'}, {'caller': 'check_rotational_invariance', 'callee': 'np.argmin'}, {'caller': 'check_rotational_invariance', 'callee': 'np.sin'}, {'caller': 'check_rotational_invariance', 'callee': 'np.cos'}, {'caller': 'check_rotational_invariance', 'callee': 'np.abs'}, {'caller': 'check_rotational_invariance', 'callee': 'compute_linf_norm'}, {'caller': 'compute_convergence_order', 'callee': 'np.log'}, {'caller': 'compute_convergence_order', 'callee': 'linregress'}]
      [1]
      - {"file":"examples/demo_transport.py","type":"main_block","line":186}
      [28] {path, purpose}
      setup.py | Setup script for smatrix_2d package.
      __init__.py | Operator-Factorized Generalized 2D Transport System
      examples/demo_transport.py | Demo script for operator-factorized 2D transport.
      tests/test_validation.py | Tests for validation metrics.
      tests/test_operators.py | Tests for transport operators.
      tests/test_core.py | Tests for core modules: grid, materials, state.
      tests/test_integration.py | Integration tests for full transport pipeline.
      tests/test_transport.py | Tests for transport orchestration.
      tests/conftest.py | Pytest configuration and shared fixtures for Smatrix_2D tests.
      smatrix_2d/core/constants.py | Physics constants for 2D transport system.
      smatrix_2d/core/grid.py | Grid specifications and phase space definitions for operator-factorized transport.
      smatrix_2d/core/materials.py | Material properties for 2D transport.
      smatrix_2d/core/__init__.py | Core data structures for operator-factorized 2D transport.
      smatrix_2d/core/state.py | Transport state management for 4D phase space.
      smatrix_2d/gpu/__init__.py | GPU acceleration package.
      smatrix_2d/gpu/kernels.py | GPU kernels for operator-factorized transport using Numba/CuPy.
      smatrix_2d/gpu/memory_layout.py | GPU memory layout management for operator-factorized transport.
      smatrix_2d/validation/tests.py | Validation test suite for operator-factorized transport.
      smatrix_2d/validation/__init__.py | Validation package.
      smatrix_2d/validation/metrics.py | Validation metrics for transport system.
      smatrix_2d/transport/transport_step.py | Transport step orchestration and operator splitting.
      smatrix_2d/transport/__init__.py | Transport orchestration package.
      smatrix_2d/operators/angular_scattering.py | Angular scattering operator (A_theta).
      smatrix_2d/operators/energy_loss.py | Energy loss operator (A_E).
      smatrix_2d/operators/spatial_streaming.py | Spatial streaming operator (A_stream).
      smatrix_2d/operators/__init__.py | Transport operators package.
      smatrix_2d/utils/visualization.py | Simple visualization utilities for dose distributions.
      smatrix_2d/utils/__init__.py | Utilities package.
  definition_index:
  pattern_findings:
    existing_tests:
      count: 0
        [1]
        - pytest
    error_handling:
      language: python
        [23] {file, line, content}
        /workspaces/Smatrix_2D/smatrix_2d/gpu/__init__.py | 7 | try:
        /workspaces/Smatrix_2D/smatrix_2d/gpu/__init__.py | 13 | try:
        /workspaces/Smatrix_2D/__init__.py | 61 | try:
        /workspaces/Smatrix_2D/smatrix_2d/gpu/kernels.py | 11 | try:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 85 | /workspaces/Smatrix_2D/smatrix_2d/gpu/__init__.py | 7 | try:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 86 | /workspaces/Smatrix_2D/smatrix_2d/gpu/__init__.py | 13 | try:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 87 | /workspaces/Smatrix_2D/smatrix_2d/gpu/kernels.py | 11 | try:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 88 | /workspaces/Smatrix_2D/__init__.py | 61 | try:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 89 | /workspaces/Smatrix_2D/comprehensive_review.toon | 85 | /workspaces/Smatrix_2D/__init__.py | 61 | try:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 90 | /workspaces/Smatrix_2D/comprehensive_review.toon | 86 | /workspaces/Smatrix_2D/comprehensive_review.toon | 77 | /workspaces/Smatrix_2D/__init__.py | 61 | try:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 91 | /workspaces/Smatrix_2D/comprehensive_review.toon | 87 | /workspaces/Smatrix_2D/comprehensive_review.toon | 78 | /workspaces/Smatrix_2D/comprehensive_review.toon | 77 | /workspaces/Smatrix_2D/__init__.py | 61 | try:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 92 | /workspaces/Smatrix_2D/comprehensive_review.toon | 88 | /workspaces/Smatrix_2D/comprehensive_review.toon | 79 | /workspaces/Smatrix_2D/comprehensive_review.toon | 78 | /workspaces/Smatrix_2D/gpu/__init__.py | 5 | try:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 93 | /workspaces/Smatrix_2D/comprehensive_review.toon | 89 | /workspaces/Smatrix_2D/comprehensive_review.toon | 80 | /workspaces/Smatrix_2D/comprehensive_review.toon | 79 | /workspaces/Smatrix_2D/comprehensive_review.toon | 77 | /workspaces/Smatrix_2D/__init__.py | 61 | try:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 94 | /workspaces/Smatrix_2D/comprehensive_review.toon | 90 | /workspaces/Smatrix_2D/comprehensive_review.toon | 81 | /workspaces/Smatrix_2D/comprehensive_review.toon | 80 | /workspaces/Smatrix_2D/comprehensive_review.toon | 78 | /workspaces/Smatrix_2D/gpu/kernels.py | 10 | try:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 95 | /workspaces/Smatrix_2D/comprehensive_review.toon | 91 | /workspaces/Smatrix_2D/comprehensive_review.toon | 82 | /workspaces/Smatrix_2D/comprehensive_review.toon | 81 | /workspaces/Smatrix_2D/comprehensive_review.toon | 79 | /workspaces/Smatrix_2D/gpu/__init__.py | 5 | try:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 96 | /workspaces/Smatrix_2D/comprehensive_review.toon | 92 | /workspaces/Smatrix_2D/comprehensive_review.toon | 83 | /workspaces/Smatrix_2D/comprehensive_review.toon | 82 | /workspaces/Smatrix_2D/gpu/kernels.py | 10 | try:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 97 | /workspaces/Smatrix_2D/comprehensive_review.toon | 93 | /workspaces/Smatrix_2D/comprehensive_review.toon | 84 | /workspaces/Smatrix_2D/gpu/kernels.py | 9 | try:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 98 | /workspaces/Smatrix_2D/comprehensive_review.toon | 94 | /workspaces/Smatrix_2D/comprehensive_review.toon | 85 | /workspaces/Smatrix_2D/gpu/__init__.py | 5 | try:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 99 | /workspaces/Smatrix_2D/comprehensive_review.toon | 95 | /workspaces/Smatrix_2D/smatrix_2d/gpu/__init__.py | 7 | try:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 100 | /workspaces/Smatrix_2D/comprehensive_review.toon | 96 | /workspaces/Smatrix_2D/smatrix_2d/gpu/__init__.py | 13 | try:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 101 | /workspaces/Smatrix_2D/comprehensive_review.toon | 97 | /workspaces/Smatrix_2D/smatrix_2d/gpu/kernels.py | 11 | try:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 102 | /workspaces/Smatrix_2D/comprehensive_review.toon | 256 | ERROR | ruff | smatrix_2d/gpu/__init__.py | 8 | F401: `cupy` imported but unused; consider using `importlib.util.find_spec` to test for availability |     import cupy as cp | ['try:'] | ['    GPU_AVAILABLE = True']
        /workspaces/Smatrix_2D/comprehensive_review.toon | 270 | ERROR | ruff | smatrix_2d/gpu/__init__.py | 8 | F401: `cupy` imported but unused; consider using `importlib.util.find_spec` to test for availability |     import cupy as cp | ['try:'] | ['    GPU_AVAILABLE = True']
        [50] {file, line, content}
        /workspaces/Smatrix_2D/tests/test_core.py | 84 | """Test that negative grid dimensions raise ValueError."""
        /workspaces/Smatrix_2D/tests/test_core.py | 93 | """Test that zero grid dimensions raise ValueError."""
        /workspaces/Smatrix_2D/smatrix_2d/core/grid.py | 62 | raise ValueError(
        /workspaces/Smatrix_2D/smatrix_2d/core/grid.py | 67 | raise ValueError(
        /workspaces/Smatrix_2D/smatrix_2d/core/grid.py | 73 | raise ValueError(
        /workspaces/Smatrix_2D/smatrix_2d/core/grid.py | 149 | raise ValueError(
        /workspaces/Smatrix_2D/smatrix_2d/core/grid.py | 156 | raise ValueError(f"Unknown energy grid type: {grid_type}")
        /workspaces/Smatrix_2D/smatrix_2d/core/state.py | 55 | raise ValueError(
        /workspaces/Smatrix_2D/smatrix_2d/core/materials.py | 32 | raise ValueError(f"Density must be positive: rho={self.rho}")
        /workspaces/Smatrix_2D/smatrix_2d/core/materials.py | 35 | raise ValueError(f"Radiation length must be positive: X0={self.X0}")
        /workspaces/Smatrix_2D/smatrix_2d/core/materials.py | 38 | raise ValueError(f"Mean excitation energy must be positive: I={self.I_excitation}")
        /workspaces/Smatrix_2D/smatrix_2d/operators/angular_scattering.py | 177 | raise ValueError(f"Unknown energy policy: {self.energy_policy}")
        /workspaces/Smatrix_2D/smatrix_2d/gpu/kernels.py | 57 | raise RuntimeError("CuPy not available. Install: pip install cupy-cudaXX")
        /workspaces/Smatrix_2D/smatrix_2d/transport/transport_step.py | 169 | raise ValueError(f"Unknown splitting type: {self.splitting}")
        /workspaces/Smatrix_2D/comprehensive_review.toon | 104 | /workspaces/Smatrix_2D/smatrix_2d/operators/angular_scattering.py | 177 | raise ValueError(f"Unknown energy policy: {self.energy_policy}")
        /workspaces/Smatrix_2D/comprehensive_review.toon | 105 | /workspaces/Smatrix_2D/smatrix_2d/core/state.py | 55 | raise ValueError(
        /workspaces/Smatrix_2D/comprehensive_review.toon | 106 | /workspaces/Smatrix_2D/smatrix_2d/core/materials.py | 32 | raise ValueError(f"Density must be positive: rho={self.rho}")
        /workspaces/Smatrix_2D/comprehensive_review.toon | 107 | /workspaces/Smatrix_2D/smatrix_2d/core/materials.py | 35 | raise ValueError(f"Radiation length must be positive: X0={self.X0}")
        /workspaces/Smatrix_2D/comprehensive_review.toon | 108 | /workspaces/Smatrix_2D/smatrix_2d/core/materials.py | 38 | raise ValueError(f"Mean excitation energy must be positive: I={self.I_excitation}")
        /workspaces/Smatrix_2D/comprehensive_review.toon | 109 | /workspaces/Smatrix_2D/smatrix_2d/gpu/kernels.py | 57 | raise RuntimeError("CuPy not available. Install: pip install cupy-cudaXX")
        /workspaces/Smatrix_2D/comprehensive_review.toon | 110 | /workspaces/Smatrix_2D/smatrix_2d/transport/transport_step.py | 169 | raise ValueError(f"Unknown splitting type: {self.splitting}")
        /workspaces/Smatrix_2D/comprehensive_review.toon | 111 | /workspaces/Smatrix_2D/comprehensive_review.toon | 99 | /workspaces/Smatrix_2D/smatrix_2d/transport/transport_step.py | 169 | raise ValueError(f"Unknown splitting type: {self.splitting}")
        /workspaces/Smatrix_2D/comprehensive_review.toon | 112 | /workspaces/Smatrix_2D/comprehensive_review.toon | 100 | /workspaces/Smatrix_2D/smatrix_2d/operators/angular_scattering.py | 177 | raise ValueError(f"Unknown energy policy: {self.energy_policy}")
        /workspaces/Smatrix_2D/comprehensive_review.toon | 113 | /workspaces/Smatrix_2D/comprehensive_review.toon | 101 | /workspaces/Smatrix_2D/smatrix_2d/gpu/kernels.py | 57 | raise RuntimeError("CuPy not available. Install: pip install cupy-cudaXX")
        /workspaces/Smatrix_2D/comprehensive_review.toon | 114 | /workspaces/Smatrix_2D/comprehensive_review.toon | 102 | /workspaces/Smatrix_2D/smatrix_2d/core/grid.py | 62 | raise ValueError(
        /workspaces/Smatrix_2D/comprehensive_review.toon | 115 | /workspaces/Smatrix_2D/comprehensive_review.toon | 103 | /workspaces/Smatrix_2D/smatrix_2d/core/grid.py | 67 | raise ValueError(
        /workspaces/Smatrix_2D/comprehensive_review.toon | 116 | /workspaces/Smatrix_2D/comprehensive_review.toon | 104 | /workspaces/Smatrix_2D/smatrix_2d/core/grid.py | 73 | raise ValueError(
        /workspaces/Smatrix_2D/comprehensive_review.toon | 117 | /workspaces/Smatrix_2D/comprehensive_review.toon | 105 | /workspaces/Smatrix_2D/smatrix_2d/core/grid.py | 149 | raise ValueError(
        /workspaces/Smatrix_2D/comprehensive_review.toon | 118 | /workspaces/Smatrix_2D/comprehensive_review.toon | 106 | /workspaces/Smatrix_2D/smatrix_2d/core/grid.py | 156 | raise ValueError(f"Unknown energy grid type: {grid_type}")
        /workspaces/Smatrix_2D/comprehensive_review.toon | 119 | /workspaces/Smatrix_2D/comprehensive_review.toon | 107 | /workspaces/Smatrix_2D/smatrix_2d/core/materials.py | 32 | raise ValueError(f"Density must be positive: rho={self.rho}")
        /workspaces/Smatrix_2D/comprehensive_review.toon | 120 | /workspaces/Smatrix_2D/comprehensive_review.toon | 108 | /workspaces/Smatrix_2D/smatrix_2d/core/materials.py | 35 | raise ValueError(f"Radiation length must be positive: X0={self.X0}")
        /workspaces/Smatrix_2D/comprehensive_review.toon | 121 | /workspaces/Smatrix_2D/comprehensive_review.toon | 109 | /workspaces/Smatrix_2D/smatrix_2d/core/materials.py | 38 | raise ValueError(f"Mean excitation energy must be positive: I={self.I_excitation}")
        /workspaces/Smatrix_2D/comprehensive_review.toon | 122 | /workspaces/Smatrix_2D/comprehensive_review.toon | 110 | /workspaces/Smatrix_2D/smatrix_2d/core/state.py | 55 | raise ValueError(
        /workspaces/Smatrix_2D/comprehensive_review.toon | 123 | /workspaces/Smatrix_2D/comprehensive_review.toon | 111 | /workspaces/Smatrix_2D/comprehensive_review.toon | 87 | /workspaces/Smatrix_2D/core/materials.py | 32 | raise ValueError(f"Density must be positive: rho={self.rho}")
        /workspaces/Smatrix_2D/comprehensive_review.toon | 124 | /workspaces/Smatrix_2D/comprehensive_review.toon | 112 | /workspaces/Smatrix_2D/comprehensive_review.toon | 88 | /workspaces/Smatrix_2D/core/materials.py | 35 | raise ValueError(f"Radiation length must be positive: X0={self.X0}")
        /workspaces/Smatrix_2D/comprehensive_review.toon | 125 | /workspaces/Smatrix_2D/comprehensive_review.toon | 113 | /workspaces/Smatrix_2D/comprehensive_review.toon | 89 | /workspaces/Smatrix_2D/core/materials.py | 38 | raise ValueError(f"Mean excitation energy must be positive: I={self.I_excitation}")
        /workspaces/Smatrix_2D/comprehensive_review.toon | 126 | /workspaces/Smatrix_2D/comprehensive_review.toon | 114 | /workspaces/Smatrix_2D/comprehensive_review.toon | 90 | /workspaces/Smatrix_2D/operators/angular_scattering.py | 185 | raise ValueError(f"Unknown energy policy: {self.energy_policy}")
        /workspaces/Smatrix_2D/comprehensive_review.toon | 127 | /workspaces/Smatrix_2D/comprehensive_review.toon | 115 | /workspaces/Smatrix_2D/comprehensive_review.toon | 91 | /workspaces/Smatrix_2D/core/state.py | 55 | raise ValueError(
        /workspaces/Smatrix_2D/comprehensive_review.toon | 128 | /workspaces/Smatrix_2D/comprehensive_review.toon | 116 | /workspaces/Smatrix_2D/comprehensive_review.toon | 92 | /workspaces/Smatrix_2D/gpu/kernels.py | 51 | raise RuntimeError("CuPy not available. Install: pip install cupy-cudaXX")
        /workspaces/Smatrix_2D/comprehensive_review.toon | 129 | /workspaces/Smatrix_2D/comprehensive_review.toon | 117 | /workspaces/Smatrix_2D/comprehensive_review.toon | 93 | /workspaces/Smatrix_2D/core/grid.py | 62 | raise ValueError(
        /workspaces/Smatrix_2D/comprehensive_review.toon | 130 | /workspaces/Smatrix_2D/comprehensive_review.toon | 118 | /workspaces/Smatrix_2D/comprehensive_review.toon | 94 | /workspaces/Smatrix_2D/core/grid.py | 67 | raise ValueError(
        /workspaces/Smatrix_2D/comprehensive_review.toon | 131 | /workspaces/Smatrix_2D/comprehensive_review.toon | 119 | /workspaces/Smatrix_2D/comprehensive_review.toon | 95 | /workspaces/Smatrix_2D/core/grid.py | 73 | raise ValueError(
        /workspaces/Smatrix_2D/comprehensive_review.toon | 132 | /workspaces/Smatrix_2D/comprehensive_review.toon | 120 | /workspaces/Smatrix_2D/comprehensive_review.toon | 96 | /workspaces/Smatrix_2D/core/grid.py | 149 | raise ValueError(
        /workspaces/Smatrix_2D/comprehensive_review.toon | 133 | /workspaces/Smatrix_2D/comprehensive_review.toon | 121 | /workspaces/Smatrix_2D/comprehensive_review.toon | 97 | /workspaces/Smatrix_2D/core/grid.py | 156 | raise ValueError(f"Unknown energy grid type: {grid_type}")
        /workspaces/Smatrix_2D/comprehensive_review.toon | 134 | /workspaces/Smatrix_2D/comprehensive_review.toon | 122 | /workspaces/Smatrix_2D/comprehensive_review.toon | 98 | /workspaces/Smatrix_2D/transport/transport_step.py | 169 | raise ValueError(f"Unknown splitting type: {self.splitting}")
        /workspaces/Smatrix_2D/comprehensive_review.toon | 135 | /workspaces/Smatrix_2D/comprehensive_review.toon | 123 | /workspaces/Smatrix_2D/comprehensive_review.toon | 99 | /workspaces/Smatrix_2D/comprehensive_review.toon | 84 | /workspaces/Smatrix_2D/transport/transport_step.py | 169 | raise ValueError(f"Unknown splitting type: {self.splitting}")
        /workspaces/Smatrix_2D/comprehensive_review.toon | 136 | /workspaces/Smatrix_2D/comprehensive_review.toon | 124 | /workspaces/Smatrix_2D/comprehensive_review.toon | 100 | /workspaces/Smatrix_2D/comprehensive_review.toon | 85 | /workspaces/Smatrix_2D/comprehensive_review.toon | 81 | /workspaces/Smatrix_2D/operators/angular_scattering.py | 180 | raise ValueError(f"Unknown energy policy: {self.energy_policy}")
        /workspaces/Smatrix_2D/comprehensive_review.toon | 137 | /workspaces/Smatrix_2D/comprehensive_review.toon | 125 | /workspaces/Smatrix_2D/comprehensive_review.toon | 101 | /workspaces/Smatrix_2D/comprehensive_review.toon | 86 | /workspaces/Smatrix_2D/comprehensive_review.toon | 82 | /workspaces/Smatrix_2D/core/state.py | 50 | raise ValueError(
        /workspaces/Smatrix_2D/comprehensive_review.toon | 138 | /workspaces/Smatrix_2D/comprehensive_review.toon | 126 | /workspaces/Smatrix_2D/comprehensive_review.toon | 102 | /workspaces/Smatrix_2D/comprehensive_review.toon | 87 | /workspaces/Smatrix_2D/comprehensive_review.toon | 83 | /workspaces/Smatrix_2D/core/grid.py | 62 | raise ValueError(
        /workspaces/Smatrix_2D/comprehensive_review.toon | 139 | /workspaces/Smatrix_2D/comprehensive_review.toon | 127 | /workspaces/Smatrix_2D/comprehensive_review.toon | 103 | /workspaces/Smatrix_2D/comprehensive_review.toon | 88 | /workspaces/Smatrix_2D/comprehensive_review.toon | 84 | /workspaces/Smatrix_2D/core/grid.py | 67 | raise ValueError(
        [27] {file, line, content}
        /workspaces/Smatrix_2D/smatrix_2d/gpu/kernels.py | 14 | except ImportError:
        /workspaces/Smatrix_2D/smatrix_2d/gpu/__init__.py | 10 | except ImportError:
        /workspaces/Smatrix_2D/smatrix_2d/gpu/__init__.py | 19 | except ImportError:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 155 | /workspaces/Smatrix_2D/spec.md | 693 | * conservation holds (except boundary leak)
        /workspaces/Smatrix_2D/comprehensive_review.toon | 156 | /workspaces/Smatrix_2D/smatrix_2d/gpu/__init__.py | 10 | except ImportError:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 157 | /workspaces/Smatrix_2D/smatrix_2d/gpu/__init__.py | 19 | except ImportError:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 158 | /workspaces/Smatrix_2D/smatrix_2d/gpu/kernels.py | 14 | except ImportError:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 159 | /workspaces/Smatrix_2D/comprehensive_review.toon | 150 | /workspaces/Smatrix_2D/__init__.py | 72 | except ImportError:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 160 | /workspaces/Smatrix_2D/comprehensive_review.toon | 151 | /workspaces/Smatrix_2D/spec.md | 693 | * conservation holds (except boundary leak)
        /workspaces/Smatrix_2D/comprehensive_review.toon | 161 | /workspaces/Smatrix_2D/comprehensive_review.toon | 152 | /workspaces/Smatrix_2D/smatrix_2d/gpu/__init__.py | 10 | except ImportError:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 162 | /workspaces/Smatrix_2D/comprehensive_review.toon | 153 | /workspaces/Smatrix_2D/smatrix_2d/gpu/__init__.py | 19 | except ImportError:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 163 | /workspaces/Smatrix_2D/comprehensive_review.toon | 154 | /workspaces/Smatrix_2D/smatrix_2d/gpu/kernels.py | 14 | except ImportError:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 164 | /workspaces/Smatrix_2D/comprehensive_review.toon | 155 | /workspaces/Smatrix_2D/comprehensive_review.toon | 124 | /workspaces/Smatrix_2D/__init__.py | 72 | except ImportError:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 165 | /workspaces/Smatrix_2D/comprehensive_review.toon | 156 | /workspaces/Smatrix_2D/comprehensive_review.toon | 125 | /workspaces/Smatrix_2D/gpu/kernels.py | 12 | except ImportError:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 166 | /workspaces/Smatrix_2D/comprehensive_review.toon | 157 | /workspaces/Smatrix_2D/comprehensive_review.toon | 126 | /workspaces/Smatrix_2D/gpu/__init__.py | 12 | except ImportError:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 167 | /workspaces/Smatrix_2D/comprehensive_review.toon | 158 | /workspaces/Smatrix_2D/comprehensive_review.toon | 127 | /workspaces/Smatrix_2D/spec.md | 693 | * conservation holds (except boundary leak)
        /workspaces/Smatrix_2D/comprehensive_review.toon | 168 | /workspaces/Smatrix_2D/comprehensive_review.toon | 159 | /workspaces/Smatrix_2D/comprehensive_review.toon | 128 | /workspaces/Smatrix_2D/comprehensive_review.toon | 109 | /workspaces/Smatrix_2D/__init__.py | 72 | except ImportError:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 169 | /workspaces/Smatrix_2D/comprehensive_review.toon | 160 | /workspaces/Smatrix_2D/comprehensive_review.toon | 129 | /workspaces/Smatrix_2D/comprehensive_review.toon | 110 | /workspaces/Smatrix_2D/gpu/kernels.py | 13 | except ImportError:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 170 | /workspaces/Smatrix_2D/comprehensive_review.toon | 161 | /workspaces/Smatrix_2D/comprehensive_review.toon | 130 | /workspaces/Smatrix_2D/comprehensive_review.toon | 111 | /workspaces/Smatrix_2D/comprehensive_review.toon | 94 | /workspaces/Smatrix_2D/__init__.py | 72 | except ImportError:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 171 | /workspaces/Smatrix_2D/comprehensive_review.toon | 162 | /workspaces/Smatrix_2D/comprehensive_review.toon | 131 | /workspaces/Smatrix_2D/comprehensive_review.toon | 112 | /workspaces/Smatrix_2D/comprehensive_review.toon | 95 | /workspaces/Smatrix_2D/spec.md | 693 | * conservation holds (except boundary leak)
        /workspaces/Smatrix_2D/comprehensive_review.toon | 172 | /workspaces/Smatrix_2D/comprehensive_review.toon | 163 | /workspaces/Smatrix_2D/comprehensive_review.toon | 132 | /workspaces/Smatrix_2D/comprehensive_review.toon | 113 | /workspaces/Smatrix_2D/comprehensive_review.toon | 96 | /workspaces/Smatrix_2D/gpu/kernels.py | 13 | except ImportError:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 173 | /workspaces/Smatrix_2D/comprehensive_review.toon | 164 | /workspaces/Smatrix_2D/comprehensive_review.toon | 133 | /workspaces/Smatrix_2D/comprehensive_review.toon | 114 | /workspaces/Smatrix_2D/comprehensive_review.toon | 97 | /workspaces/Smatrix_2D/gpu/__init__.py | 12 | except ImportError:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 174 | /workspaces/Smatrix_2D/comprehensive_review.toon | 165 | /workspaces/Smatrix_2D/comprehensive_review.toon | 134 | /workspaces/Smatrix_2D/comprehensive_review.toon | 115 | /workspaces/Smatrix_2D/gpu/__init__.py | 12 | except ImportError:
        /workspaces/Smatrix_2D/comprehensive_review.toon | 175 | /workspaces/Smatrix_2D/comprehensive_review.toon | 166 | /workspaces/Smatrix_2D/comprehensive_review.toon | 135 | /workspaces/Smatrix_2D/comprehensive_review.toon | 116 | /workspaces/Smatrix_2D/spec.md | 693 | * conservation holds (except boundary leak)
        /workspaces/Smatrix_2D/comprehensive_review.toon | 176 | /workspaces/Smatrix_2D/__init__.py | 72 | except ImportError:
        /workspaces/Smatrix_2D/__init__.py | 72 | except ImportError:
        /workspaces/Smatrix_2D/spec.md | 693 | * conservation holds (except boundary leak)
      total_error_handlers: 100
    technical_debt:
      total_count: 28
      by_type:
        TODO: 5
        FIXME: 5
        HACK: 5
        XXX: 5
        NOTE: 8
        [28] {file, line, content}
        /workspaces/Smatrix_2D/comprehensive_review.toon | 181 | TODO: 4
        /workspaces/Smatrix_2D/comprehensive_review.toon | 187 | /workspaces/Smatrix_2D/comprehensive_review.toon | 171 | TODO: 3
        /workspaces/Smatrix_2D/comprehensive_review.toon | 188 | /workspaces/Smatrix_2D/comprehensive_review.toon | 177 | /workspaces/Smatrix_2D/comprehensive_review.toon | 140 | TODO: 2
        /workspaces/Smatrix_2D/comprehensive_review.toon | 189 | /workspaces/Smatrix_2D/comprehensive_review.toon | 178 | /workspaces/Smatrix_2D/comprehensive_review.toon | 146 | /workspaces/Smatrix_2D/comprehensive_review.toon | 121 | TODO: 1
        /workspaces/Smatrix_2D/comprehensive_review.toon | 190 | /workspaces/Smatrix_2D/comprehensive_review.toon | 179 | /workspaces/Smatrix_2D/comprehensive_review.toon | 147 | /workspaces/Smatrix_2D/comprehensive_review.toon | 127 | /workspaces/Smatrix_2D/comprehensive_review.toon | 102 | TODO: 0
        /workspaces/Smatrix_2D/comprehensive_review.toon | 182 | FIXME: 4
        /workspaces/Smatrix_2D/comprehensive_review.toon | 191 | /workspaces/Smatrix_2D/comprehensive_review.toon | 172 | FIXME: 3
        /workspaces/Smatrix_2D/comprehensive_review.toon | 192 | /workspaces/Smatrix_2D/comprehensive_review.toon | 180 | /workspaces/Smatrix_2D/comprehensive_review.toon | 141 | FIXME: 2
        /workspaces/Smatrix_2D/comprehensive_review.toon | 193 | /workspaces/Smatrix_2D/comprehensive_review.toon | 181 | /workspaces/Smatrix_2D/comprehensive_review.toon | 148 | /workspaces/Smatrix_2D/comprehensive_review.toon | 122 | FIXME: 1
        /workspaces/Smatrix_2D/comprehensive_review.toon | 194 | /workspaces/Smatrix_2D/comprehensive_review.toon | 182 | /workspaces/Smatrix_2D/comprehensive_review.toon | 149 | /workspaces/Smatrix_2D/comprehensive_review.toon | 128 | /workspaces/Smatrix_2D/comprehensive_review.toon | 103 | FIXME: 0
        /workspaces/Smatrix_2D/comprehensive_review.toon | 183 | HACK: 4
        /workspaces/Smatrix_2D/comprehensive_review.toon | 195 | /workspaces/Smatrix_2D/comprehensive_review.toon | 173 | HACK: 3
        /workspaces/Smatrix_2D/comprehensive_review.toon | 196 | /workspaces/Smatrix_2D/comprehensive_review.toon | 183 | /workspaces/Smatrix_2D/comprehensive_review.toon | 142 | HACK: 2
        /workspaces/Smatrix_2D/comprehensive_review.toon | 197 | /workspaces/Smatrix_2D/comprehensive_review.toon | 184 | /workspaces/Smatrix_2D/comprehensive_review.toon | 150 | /workspaces/Smatrix_2D/comprehensive_review.toon | 123 | HACK: 1
        /workspaces/Smatrix_2D/comprehensive_review.toon | 198 | /workspaces/Smatrix_2D/comprehensive_review.toon | 185 | /workspaces/Smatrix_2D/comprehensive_review.toon | 151 | /workspaces/Smatrix_2D/comprehensive_review.toon | 129 | /workspaces/Smatrix_2D/comprehensive_review.toon | 104 | HACK: 0
        /workspaces/Smatrix_2D/comprehensive_review.toon | 184 | XXX: 4
        /workspaces/Smatrix_2D/comprehensive_review.toon | 199 | /workspaces/Smatrix_2D/comprehensive_review.toon | 174 | XXX: 3
        /workspaces/Smatrix_2D/comprehensive_review.toon | 200 | /workspaces/Smatrix_2D/comprehensive_review.toon | 186 | /workspaces/Smatrix_2D/comprehensive_review.toon | 143 | XXX: 2
        /workspaces/Smatrix_2D/comprehensive_review.toon | 201 | /workspaces/Smatrix_2D/comprehensive_review.toon | 187 | /workspaces/Smatrix_2D/comprehensive_review.toon | 152 | /workspaces/Smatrix_2D/comprehensive_review.toon | 124 | XXX: 1
        /workspaces/Smatrix_2D/comprehensive_review.toon | 202 | /workspaces/Smatrix_2D/comprehensive_review.toon | 188 | /workspaces/Smatrix_2D/comprehensive_review.toon | 153 | /workspaces/Smatrix_2D/comprehensive_review.toon | 130 | /workspaces/Smatrix_2D/comprehensive_review.toon | 105 | XXX: 0
        /workspaces/Smatrix_2D/comprehensive_review.toon | 185 | NOTE: 6
        /workspaces/Smatrix_2D/comprehensive_review.toon | 203 | /workspaces/Smatrix_2D/comprehensive_review.toon | 175 | NOTE: 4
        /workspaces/Smatrix_2D/comprehensive_review.toon | 204 | /workspaces/Smatrix_2D/comprehensive_review.toon | 189 | /workspaces/Smatrix_2D/comprehensive_review.toon | 144 | NOTE: 2
        /workspaces/Smatrix_2D/comprehensive_review.toon | 205 | /workspaces/Smatrix_2D/comprehensive_review.toon | 190 | /workspaces/Smatrix_2D/comprehensive_review.toon | 154 | /workspaces/Smatrix_2D/comprehensive_review.toon | 125 | NOTE: 1
        /workspaces/Smatrix_2D/comprehensive_review.toon | 206 | /workspaces/Smatrix_2D/comprehensive_review.toon | 191 | /workspaces/Smatrix_2D/comprehensive_review.toon | 155 | /workspaces/Smatrix_2D/comprehensive_review.toon | 131 | /workspaces/Smatrix_2D/comprehensive_review.toon | 106 | NOTE: 0
        /workspaces/Smatrix_2D/comprehensive_review.toon | 207 | /workspaces/Smatrix_2D/comprehensive_review.toon | 192 | /workspaces/Smatrix_2D/tests/test_integration.py | 50 | # Note: Test currently fails due to architectural issue - EnergyLossOperator
        /workspaces/Smatrix_2D/comprehensive_review.toon | 208 | /workspaces/Smatrix_2D/tests/test_integration.py | 50 | # Note: Test currently fails due to architectural issue - EnergyLossOperator
        /workspaces/Smatrix_2D/tests/test_integration.py | 50 | # Note: Test currently fails due to architectural issue - EnergyLossOperator
      [50] {caller, callee, file}
      main | PhysicsConstants2D | examples/demo_transport.py
      main | np.argmax | examples/demo_transport.py
      main | SpatialStreamingOperator | examples/demo_transport.py
      main | abs | examples/demo_transport.py
      main | create_initial_state | examples/demo_transport.py
      main | state.total_weight | examples/demo_transport.py
      main | state.total_dose | examples/demo_transport.py
      main | GridSpecs2D | examples/demo_transport.py
      main | EnergyLossOperator | examples/demo_transport.py
      main | AngularScatteringOperator | examples/demo_transport.py
      main | create_phase_space_grid | examples/demo_transport.py
      main | transport.apply | examples/demo_transport.py
      main | plot_depth_dose | examples/demo_transport.py
      main | plot_lateral_profile | examples/demo_transport.py
      main | plot_dose_map | examples/demo_transport.py
      main | np.sum | examples/demo_transport.py
      main | create_water_material | examples/demo_transport.py
      main | FirstOrderSplitting | examples/demo_transport.py
      test_identical_distributions | pytest.approx | tests/test_validation.py
      test_identical_distributions | compute_l2_norm | tests/test_validation.py
      test_identical_distributions | np.ones | tests/test_validation.py
      test_identical_distributions | compute_gamma_pass_rate | tests/test_validation.py
      test_identical_distributions | np.arange | tests/test_validation.py
      test_identical_distributions | compute_linf_norm | tests/test_validation.py
      test_scaled_distribution | compute_l2_norm | tests/test_validation.py
      test_scaled_distribution | np.ones | tests/test_validation.py
      test_scaled_distribution | pytest.approx | tests/test_validation.py
      test_zero_reference | pytest.approx | tests/test_validation.py
      test_zero_reference | np.zeros | tests/test_validation.py
      test_zero_reference | compute_l2_norm | tests/test_validation.py
      test_zero_reference | np.ones | tests/test_validation.py
      test_zero_reference | compute_linf_norm | tests/test_validation.py
      test_with_roi_mask | compute_l2_norm | tests/test_validation.py
      test_with_roi_mask | np.ones | tests/test_validation.py
      test_with_roi_mask | np.zeros | tests/test_validation.py
      test_max_difference | compute_linf_norm | tests/test_validation.py
      test_max_difference | np.ones | tests/test_validation.py
      test_max_difference | pytest.approx | tests/test_validation.py
      test_localized_difference | compute_linf_norm | tests/test_validation.py
      test_localized_difference | np.ones | tests/test_validation.py
      test_localized_difference | pytest.approx | tests/test_validation.py
      test_dose_difference_below_threshold | np.ones | tests/test_validation.py
      test_dose_difference_below_threshold | compute_gamma_pass_rate | tests/test_validation.py
      test_dose_difference_below_threshold | np.arange | tests/test_validation.py
      test_with_custom_roi | pytest.approx | tests/test_validation.py
      test_with_custom_roi | np.zeros | tests/test_validation.py
      test_with_custom_roi | np.ones | tests/test_validation.py
      test_with_custom_roi | compute_gamma_pass_rate | tests/test_validation.py
      test_with_custom_roi | np.arange | tests/test_validation.py
      test_empty_roi | pytest.approx | tests/test_validation.py
execution_time_ms: 0
  [5] {gate, threshold, actual, status}
  linting_errors | <50 | 22 | PASS
  type_coverage | >80% | 100.0% | PASS
  security_critical | 0 | 0 | PASS
  cognitive_complexity | <12 | 40 | FAIL
  dead_code | <5 | 0 | PASS
  [24] {severity, tool, file, line, issue, snippet, context_before, context_after}
  ERROR | complexipy | Smatrix_2D/smatrix_2d/gpu/kernels.py | 0 | Cognitive complexity 40 (F-grade) in GPUTransportStep::_spatial_streaming_kernel |  | [] | []
  ERROR | complexipy | Smatrix_2D/smatrix_2d/gpu/kernels.py | 0 | Cognitive complexity 26 (F-grade) in GPUTransportStep::_energy_loss_kernel |  | [] | []
  ERROR | ruff | smatrix_2d/gpu/__init__.py | 8 | F401: `cupy` imported but unused; consider using `importlib.util.find_spec` to test for availability |     import cupy as cp | ['try:'] | ['    GPU_AVAILABLE = True']
  ERROR | ruff | smatrix_2d/gpu/kernels.py | 126 | F821: Undefined name `theta` |         v_x = cp.cos(theta) | [''] | ['        v_z = cp.sin(theta)']
  ERROR | ruff | smatrix_2d/gpu/kernels.py | 127 | F821: Undefined name `theta` |         v_z = cp.sin(theta) | ['        v_x = cp.cos(theta)'] | ['']
  ERROR | ruff | smatrix_2d/gpu/kernels.py | 182 | F821: Undefined name `psi_in` |         psi_out = cp.zeros_like(psi_in) | ['        """'] | ['        deposited_energy = cp.zeros((self.Nz, self.Nx), dtype=cp.float32)']
  ERROR | ruff | smatrix_2d/gpu/kernels.py | 195 | F821: Undefined name `psi_in` |                 deposited_energy += cp.sum(psi_in[iE_src, :, :, :]) * residual_energy | ['                residual_energy = max(0.0, E_new)'] | ['                continue']
  ERROR | ruff | smatrix_2d/gpu/kernels.py | 217 | F821: Undefined name `psi_in` |                         weight = psi_in[iE_src, ith, iz, ix] | ['                    for ix in range(self.Nx):'] | ['']
  ERROR | ruff | smatrix_2d/operators/spatial_streaming.py | 13 | F811: Redefinition of unused `Tuple` from line 9 | from typing import List, Tuple | ['from smatrix_2d.core.constants import PhysicsConstants2D'] | ['']
  ERROR | ruff | smatrix_2d/operators/spatial_streaming.py | 82 | F841: Local variable `mu` is assigned to but never used |         mu = np.cos(theta) | ['        """'] | ['        eta = np.sin(theta)']
  ERROR | ruff | smatrix_2d/operators/spatial_streaming.py | 290 | F841: Local variable `mu` is assigned to but never used |         mu = np.cos(theta)  # x-component | ['        theta = self.grid.th_centers[ith]'] | ['        eta = np.sin(theta)  # z-component (forward direction)']
  ERROR | ruff | tests/conftest.py | 6 | F401: `smatrix_2d.core.grid.PhaseSpaceGrid2D` imported but unused | from smatrix_2d.core.grid import GridSpecs2D, PhaseSpaceGrid2D, create_phase_space_grid, EnergyGridType | [''] | ['from smatrix_2d.core.materials import MaterialProperties2D, create_water_material']
  ERROR | ruff | tests/conftest.py | 7 | F401: `smatrix_2d.core.materials.MaterialProperties2D` imported but unused | from smatrix_2d.core.materials import MaterialProperties2D, create_water_material | ['from smatrix_2d.core.grid import GridSpecs2D, PhaseSpaceGrid2D, create_phase_space_grid, EnergyGridType'] | ['from smatrix_2d.core.state import TransportState, create_initial_state']
  ERROR | ruff | tests/test_core.py | 5 | F401: `numpy.testing.assert_array_equal` imported but unused | from numpy.testing import assert_allclose, assert_array_equal | ['import numpy as np'] | ['']
  ERROR | ruff | tests/test_core.py | 16 | F401: `smatrix_2d.core.constants.PhysicsConstants2D` imported but unused | from smatrix_2d.core.constants import PhysicsConstants2D | ['from smatrix_2d.core.state import TransportState, create_initial_state'] | ['']
  ERROR | ruff | tests/test_integration.py | 8 | F401: `smatrix_2d.transport.transport_step.FirstOrderSplitting` imported but unused | from smatrix_2d.transport.transport_step import FirstOrderSplitting | ['from smatrix_2d.core.state import create_initial_state'] | ['']
  ERROR | ruff | tests/test_integration.py | 75 | F841: Local variable `initial_angle` is assigned to but never used |         initial_angle = np.pi / 2 | ['        initial_weight = state.total_weight()'] | ['']
  ERROR | ruff | tests/test_operators.py | 5 | F401: `numpy.testing.assert_array_less` imported but unused | from numpy.testing import assert_allclose, assert_array_less | ['import numpy as np'] | ['']
  ERROR | ruff | tests/test_operators.py | 8 | F401: `smatrix_2d.operators.angular_scattering.AngularScatteringOperator` imported but unused |     AngularScatteringOperator, | ['from smatrix_2d.operators.angular_scattering import ('] | ['    EnergyReferencePolicy,']
  ERROR | ruff | tests/test_operators.py | 12 | F401: `smatrix_2d.operators.spatial_streaming.SpatialStreamingOperator` imported but unused |     SpatialStreamingOperator, | ['from smatrix_2d.operators.spatial_streaming import ('] | ['    BackwardTransportMode,']
  ERROR | ruff | tests/test_operators.py | 15 | F401: `smatrix_2d.operators.energy_loss.EnergyLossOperator` imported but unused | from smatrix_2d.operators.energy_loss import EnergyLossOperator | [')'] | ['']
  ERROR | ruff | tests/test_transport.py | 168 | F821: Undefined name `AngularScatteringOperator` |         A_theta_vac = AngularScatteringOperator(grid, vacuum, angular_operator.constants) | ['        # Vacuum operators'] | ['        A_stream_vac = spatial_operator  # Same spatial operator']
  ERROR | ruff | tests/test_transport.py | 170 | F821: Undefined name `EnergyLossOperator` |         A_E_vac = EnergyLossOperator(grid) | ['        A_stream_vac = spatial_operator  # Same spatial operator'] | ['']
  ERROR | ruff | tests/test_validation.py | 5 | F401: `numpy.testing.assert_allclose` imported but unused | from numpy.testing import assert_allclose | ['import numpy as np'] | ['']
ruff:
  total: 22
  auto_fixable: 14
  severity_counts:
    error: 22
    warning: 0
    info: 0
ty:
  total: 0
  type_coverage: 100.0%
  files_checked: 28
  files_with_errors: 0
semgrep:
  total: 0
  severity_counts:
    ERROR: 0
    WARNING: 0
    INFO: 0
complexipy:
  avg_complexity: 1.3
  total_functions: 192
skylos:
  total_dead_code: 0
  confidence_level: 60
  [2] {pattern, variants, recommendation}
  docstring_style | [{'style': 'Google style', 'count': 12}, {'style': 'Plain docstrings', 'count': 18}] | Standardize on Plain docstrings
  missing_docstrings | [{'style': 'functions without docstrings', 'files': ['tests/test_integration.py', 'tests/conftest.py', 'tests/test_operators.py', 'smatrix_2d/validation/tests.py', 'tests/test_transport.py'], 'count': 6}] | Add docstrings to public functions
  [9] {theme, file, issue_count, tools, suggested_action, cluster_id}
  Multiple issues in kernels.py | Smatrix_2D/smatrix_2d/gpu/kernels.py | 2 | ['complexipy'] | Review and fix 2 issues in Smatrix_2D/smatrix_2d/gpu/kernels.py | 1
  Multiple issues in kernels.py | smatrix_2d/gpu/kernels.py | 5 | ['ruff'] | Review and fix 5 issues in smatrix_2d/gpu/kernels.py | 2
  Multiple issues in spatial_streaming.py | smatrix_2d/operators/spatial_streaming.py | 3 | ['ruff'] | Review and fix 3 issues in smatrix_2d/operators/spatial_streaming.py | 3
  Multiple issues in conftest.py | tests/conftest.py | 2 | ['ruff'] | Review and fix 2 issues in tests/conftest.py | 4
  Multiple issues in test_core.py | tests/test_core.py | 2 | ['ruff'] | Review and fix 2 issues in tests/test_core.py | 5
  Multiple issues in test_integration.py | tests/test_integration.py | 2 | ['ruff'] | Review and fix 2 issues in tests/test_integration.py | 6
  Multiple issues in test_operators.py | tests/test_operators.py | 4 | ['ruff'] | Review and fix 4 issues in tests/test_operators.py | 7
  Multiple issues in test_transport.py | tests/test_transport.py | 2 | ['ruff'] | Review and fix 2 issues in tests/test_transport.py | 8
  High cognitive complexity | None | 2 | ['complexipy'] | Refactor complex functions to improve maintainability | 9
recommendations:
    [1]
    - {"priority":"high","category":"testing","title":"Low test coverage","description":"Estimated 0.0% test coverage","action":"Add tests to improve coverage"}
    [3] {priority, action, effort}
    1 | Run: ruff check --fix . | 2min
    2 | Refactor: Smatrix_2D/smatrix_2d/gpu/kernels.py (cognitive complexity 40<12) | 2hrs
    3 | Refactor: Smatrix_2D/smatrix_2d/gpu/kernels.py (cognitive complexity 26<12) | 2hrs
    [2]
    - Refactor 2 high cognitive complexity functions (F/D grade)
    - Enable ty strict mode for enhanced type safety