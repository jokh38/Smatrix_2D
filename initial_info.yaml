# ==============================================================================
# INITIAL PARTICLE STATE
# ==============================================================================
# User-configurable simulation scenario for Smatrix 2D
# Physics models are determined by NIST/PDG data - not configurable here
# ==============================================================================

particle:
  # Initial beam energy
  energy:
    value: 70.0          # MeV
    unit: MeV
    description: "Initial proton beam energy"

  # Initial beam angle (measured from +x axis, 90° = +z direction)
  angle:
    value: 90.0          # degrees
    unit: degrees
    description: "Initial beam direction (90° = along +z axis)"

  # Initial spatial position
  position:
    x:
      value: 6.0         # mm (center of [0, 12] mm domain)
      unit: mm
      description: "Initial lateral position (center of x-domain)"
    z:
      value: 0.0         # mm
      unit: mm
      description: "Initial depth position (entry surface)"

  # Initial particle weight
  weight:
    value: 1.0           # dimensionless
    description: "Initial particle weight (normalized to 1)"

# ==============================================================================
# SPATIAL GRID CONFIGURATION
# ==============================================================================
grid:
  spatial:
    x:
      min: 0.0           # mm
      max: 12.0          # mm
      delta: 1.0         # mm
      unit: mm
      description: "Lateral domain (perpendicular to beam direction)"

    z:
      min: 0.0           # mm
      max: 50.0          # mm
      delta: 1.0         # mm
      unit: mm
      description: "Depth domain (along beam direction)"

  # Angular grid (scattering angle distribution)
  angular:
    center: 90.0         # degrees (beam direction)
    half_range: 20.0     # degrees
    delta: 1.0           # degrees
    unit: degrees
    description: "Angular scattering domain (θ = center ± half_range)"

  # Energy grid (energy loss straggling)
  energy:
    min: 1.0             # MeV
    max: 70.0            # MeV
    delta: 0.2           # MeV
    cutoff: 2.0          # MeV (particles below this energy are absorbed)
    unit: MeV
    description: "Energy loss domain"

# ==============================================================================
# MATERIAL CONFIGURATION
# ==============================================================================
# Material determines which NIST/PDG physics data is loaded
# Available materials: H2O, AIR, GRAPHITE, AL, CU, PB, TISSUE_ICRU, TISSUE_ICRP, BONE_COMPACT, BONE_CORTICAL
material: "H2O"

# ==============================================================================
# NUMERICAL SAFEGUARDS
# ==============================================================================
# User-adjustable thresholds for numerical stability
numerical:
  safeguards:
    beta_sq_minimum: 1.0e-12
    log_argument_minimum: 1.0e-12
    dose_threshold: 1.0e-6
    weight_threshold: 1.0e-6
    description: "Numerical safeguards to prevent division by zero and underflow"

# ==============================================================================
# TRANSPORT SETTINGS
# ==============================================================================
transport:
  delta_s: 1.0            # mm - step size
  max_steps: 100          # Maximum number of transport steps

# ==============================================================================
# CONVERGENCE CRITERIA
# ==============================================================================
convergence:
  min_weight: 1.0e-4      # Stop when total weight falls below this threshold

# ==============================================================================
# OUTPUT CONFIGURATION
# ==============================================================================
output:
  # Output directory for all generated files
  directory: "output"

  # CSV data files
  csv:
    enabled: true
    detailed_file: "output/proton_transport_steps.csv"
    summary_file: "output/proton_transport_summary.csv"
    description: "Save particle distribution data for each transport step"

  # Figures
  figures:
    enabled: true
    format: "png"        # Options: png, pdf, svg
    dpi: 150
    files:
      depth_dose:
        filename: "output/proton_pdd.png"
        title: "Proton Percentage Depth Dose (PDD)"
        description: "Depth-dose curve showing Bragg peak"
      dose_map_2d:
        filename: "output/proton_dose_map_2d.png"
        title: "2D Dose Distribution"
        description: "2D spatial dose distribution map"
      lateral_spreading:
        filename: "output/lateral_spreading_analysis.png"
        title: "Lateral Spreading Analysis"
        description: "Analysis of lateral beam spreading with depth"

  # Console output verbosity
  verbosity: 1           # 0=minimal, 1=normal, 2=verbose
  description: "Level of detail for console output"

# ==============================================================================
# METADATA
# ==============================================================================
metadata:
  simulation_type: "GPU Monte Carlo Particle Transport"
  particle_type: "Proton"
  target_material: "Water (Liquid)"
  physics:
    - "Multiple Coulomb scattering (Molière/Highland theory)"
    - "Energy loss (Bethe-Bloch formula with NIST PSTAR data)"
    - "Spatial streaming (theta-dependent transport)"
    - "Lateral spreading (angular scattering → spatial dispersion)"
  code_version: "Smatrix_2D v2.0"
  date: "2026-01-16"
  description: "GPU-accelerated proton pencil beam dose calculation"
